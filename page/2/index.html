<!DOCTYPE html>
<html lang="en"><head><!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LQZYYM4LL2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LQZYYM4LL2');
</script>


<script>
  !function(o,e,n){var r=[];if(window.reproio)console.info("Repro Web SDK was loaded more than once");else{window.reproio=function(){r.push(arguments)};var i=o.createElement(e),t=o.getElementsByTagName(e)[0];i.src="https://cdn.reproio.com/web/v2/repro-sdk.min.js",i.async=!0,i.crossOrigin="",i.onload=function(){window.reproio("setSnippetVersion","2.1"),r.forEach(function(o){window.reproio.apply(window.reproio,o)})},t.parentNode.insertBefore(i,t)}}(document,"script");
  reproio("setup", "ff3c22fd-f7d1-4958-b16e-e57054f33d44");
  reproio("track", "pageView");
</script>
<meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Page 2 of 12 for katsyoshi ã®ã‚ã‚‚ã¿ãŸã„ãªã® - page 2 | katsyoshi ã®ã‚ã‚‚ã¿ãŸã„ãªã®</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="katsyoshi ã®ã‚ã‚‚ã¿ãŸã„ãªã® - page 2" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Itâ€™s a memos." />
<meta property="og:description" content="Itâ€™s a memos." />
<link rel="canonical" href="https://blog.katsyoshi.org/page/2/" />
<meta property="og:url" content="https://blog.katsyoshi.org/page/2/" />
<meta property="og:site_name" content="katsyoshi ã®ã‚ã‚‚ã¿ãŸã„ãªã®" />
<meta property="og:type" content="website" />
<link rel="prev" href="https://blog.katsyoshi.org/" />
<link rel="next" href="https://blog.katsyoshi.org/page/3/" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="katsyoshi ã®ã‚ã‚‚ã¿ãŸã„ãªã® - page 2" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Itâ€™s a memos.","headline":"katsyoshi ã®ã‚ã‚‚ã¿ãŸã„ãªã® - page 2","url":"https://blog.katsyoshi.org/page/2/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://blog.katsyoshi.org/feed.xml" title="katsyoshi ã®ã‚ã‚‚ã¿ãŸã„ãªã®" /></head>
<body><header class="site-header" role="banner">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">katsyoshi ã®ã‚ã‚‚ã¿ãŸã„ãªã®</a>
  </div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <!-- Pagination links -->
<div class="pagination">
  
    <a href="/" class="previous">
      Previous
    </a>
  
  <span class="page_number ">
    Page: 2 of 12
  </span>
  
    <a href="/page/3/" class="next">Next</a>
  
</div>



  <h1><a href="/blog/2023/05/15/ruby-kaigi-2023-at-matsumoto/">RubyKaigi2023 @MATZæœ¬</a></h1>
  <p class="author">
    <span class="date">2023-05-15 23:59:59 +0900</span>
  </p>
  <div class="content">
    <p>è¡Œã£ã¦ããŸã®ã§ã¾ã¨ã‚ã¾ã™ã€‚LT ã‚„ã£ãŸã®ã§ã™ãŒã€ LT ã®è©±ã¯ã¾ãŸä»Šåº¦ã€‚</p>

<h2 id="day--1">Day -1</h2>

<p>å‰æ—¥ã¯æ’ä¾‹ã® <a href="https://asakusarb.esa.io">Asakusa.rb</a> ã® <a href="https://asakusarb.doorkeeper.jp/events/154786">predrinkup</a> ã«è¡Œã£ã¦ã¾ã—ãŸã€‚ã“ã“ã§ã¯ã€ <a href="https://twitter.com/n0kada">nobu</a> ã¨ã‹ã¨ã¯ãªã—ã—ãŸã‚Šã—ã¦ã™ã”ã—ã¾ã—ãŸã€‚
drinkup ã¯æ¬¡ã®æ—¥ã®ãŸã‚çµ‚äº†å¾Œã™ãã•ã¾å¸°å®…ã—ã€å°±å¯ã—ãŸã€‚</p>

<h2 id="day-0">Day 0</h2>
<p>ã“ã®æ—¥ã¯ã€ <a href="https://cookpad.connpass.com/event/277569/">RubyistsOnRails</a> ã¨ã„ã†ã™ã°ã‚‰ã—ã„ã‚¤ãƒ™ãƒ³ãƒˆåˆ—è»ŠãŒã‚ã£ãŸã®ã§ãƒãƒ¼ã‚¿ã‚¤ãƒ  <sup id="fnref:sonnnakotohanai" role="doc-noteref"><a href="#fn:sonnnakotohanai" class="footnote" rel="footnote">1</a></sup> 8æ™‚ã®ä¼šã«å‚åŠ ç”³ã—è¾¼ã¿ã€‚6æ™‚ã«èµ·åºŠã—ã€7æ™‚ã«å‡ºç™ºã€‚
ä¼šã§ã¯Rubyistã¨è©±ã—ãªãŒã‚‰ã€å±±è¦‹ãªãŒã‚‰ã€æ¾æœ¬ã«åˆ°ç€ã€‚
æ¾æœ¬ã«åˆ°ç€å¾Œé£¯ã¨ã—ã¦ <a href="https://tabelog.com/nagano/A2002/A200201/20000092/">ã¿ã‚ˆç”°</a> ã¨ã„ã†è•éº¦å±‹ã«ç›´è¡Œã€‚
è•éº¦ã‚’é£Ÿã¹ãŸç›´å¾Œã€æ¾æœ¬åŸã¸ã€‚æ¾æœ¬åŸã§ã¯ <a href="https://twitter.com/yukihiro_matz/">ã¾ã¤ã‚‚ã¨ã•ã‚“</a> é›†å›£ã‚’è¦‹ã¤ã‘ãŸã®ã§ã€ã¿ã‚“ãªã§ Matzæœ¬åŸ èƒŒæ™¯ã«è¨˜å¿µæ’®å½±ã€‚ã¾ã¤ã‚‚ã¨ã•ã‚“ä¸€è¡Œã¯é–‹ç™ºè€…ä¼šè­°ãŒã‚ã£ãŸã‚‰ã—ãè¨˜å¿µæ’®å½±å¾Œã™ãã«ã‚ã‹ã‚Œã¾ã—ãŸã€‚
ã‚ã‚Œã‚ã‚Œã¯ã€ã“ã®è¨˜å¿µæ’®å½±å¾Œæ¾æœ¬åŸè¦³å…‰ã—ã€ã‚‚ã†ä¸€è»’è•éº¦å±‹ã¸æ˜¼é£Ÿã¸ã€‚äºŒè»’ç›®ã®è•éº¦å±‹ã¯ <a href="https://tabelog.com/nagano/A2002/A200201/20002376/">è•éº¦å€¶æ¥½éƒ¨ä½ã€…æœ¨</a> ã¸ã€‚</p>

<p>ãã‚“ãªã“ã¨ã—ã¦ãŸã‚‰å®¿ãŒãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³å¯èƒ½ã«ãªã£ãŸã®ã§ã€è·ç‰©ç½®ãã®ã¨ä¸‹ç€é¡ã‚’è³¼å…¥ã—ã²ã¨ã‚„ã™ã¿(10minç¨‹)ã€‚</p>

<p>Day 0 æœ€å¤§ã®ã‚¤ãƒ™ãƒ³ãƒˆã€ <a href="https://keebkaigi.org/2023/">KeebKaigi</a> ã¸!ã“ã“ã§è±ªè¯ãƒãƒ™ãƒªãƒ†ã‚£ã‚’å¤§é‡ã«é ‚ãã¾ã—ãŸ!!!1ã¨ãã«ã‚ˆã„ã®ãŒåŸã‚­ãƒ¼ã‚­ãƒ£ãƒƒãƒ—ã§æ¾æœ¬åŸã‚’3Dãƒ—ãƒªãƒ³ãƒˆã—ãŸISO ã‚¨ãƒ³ã‚¿ãƒ¼ã‚­ãƒ¼ã‚’é ‚ãã¾ã—ãŸã€‚ã—ã‹ã—ãªãŒã‚‰ã“ã®ã‚­ãƒ¼å·®ã™ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãŒãªã„ã®ã§çŸ¥äººã«è­²ã‚‹äºˆå®šã§ã™ã€‚</p>

<p>KeebKaigi è‡ªä½“ã‚‚ãŸã„ã¸ã‚“é¢ç™½ã„ Kaigi ã§æ¥½ã—ã‚ã¾ã—ãŸã€‚ã¨ãã«ã€ t-code ã®ç´¹ä»‹ã®LTã€é ­æ–‡å­—Vãªã©ã‚ˆã‹ã£ãŸã§ã™ã€‚
KeebKaigi å¾Œã¯æ‡‡è¦ªä¼šã«ã¯å‚åŠ ã›ãšã€å‹äººã¨ã‹ã‚‹ãå¤•é£¯ã‚’ã—ã¦å®¿ã¸ã€‚</p>

<h2 id="day-1">Day 1</h2>

<p>ã“ã“ã¾ã§ã§ã‚‚å¤§å¤‰æ¥½ã—ã„ã‚‚ã®ã§ã—ãŸãŒã€<a href="https://rubykaigi.org/2023/">RubyKaigiæœ¬ç•ª</a> ã¯ã“ã®æ—¥ã‹ã‚‰ã€‚</p>

<p>1æ—¥ç›®ã®æœé£Ÿã¯ä¼šå ´è¡Œãé€”ä¸­ã§ã‚‚ã¨ã‚‚ã¨èã„ã¦ã„ãŸåº—ã® <a href="https://sioribi.jp/">æ æ—¥</a> ã•ã‚“ã¸ã€‚
ä¼šå ´é–‹ã„ã¦ç™»éŒ²ã—ãŸã‚ã¨ãƒãƒ™ãƒªãƒ†ã‚£ã®åˆ—ã‚’ã¿ã¦ã’ã‚“ãªã‚Šã—ã¦ãŸã®ã§ä¸€æ—¦ã‚¹ãƒãƒ³ã‚µãƒ¼ãƒ–ãƒ¼ã‚¹ã‚’ã†ã‚ã†ã‚ã—ã¦ãŸã€‚
ã“ã®æ—¥èã„ãŸã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯ä»¥ä¸‹ã§ã™ã€‚</p>

<h3 id="matz-keynote"><a href="https://rubykaigi.org/2023/presentations/yukihiro_matz.html#day1">Matz Keynote</a></h3>

<p>æ¯å¹´æ’ä¾‹ Matz ã®ã‚­ãƒ¼ãƒãƒ¼ãƒˆã€‚</p>

<h3 id="æ˜¼é£¯">æ˜¼é£¯</h3>
<p>ãƒ©ãƒ³ãƒã¯ãŸã¾ãŸã¾å±…åˆã‚ã›ãŸ6äººã§ <a href="https://tabelog.com/nagano/A2002/A200201/20000098/">ãŠããªå ‚</a> ã¸ã€‚åç‰©ã®ãƒœãƒ«ã‚¬ãƒ©ã‚¤ã‚¹ã¨ãƒªãƒ³ã‚´ã‚¸ãƒ¥ãƒ¼ã‚¹ã‚’ã€‚ã‚·ãƒ¼ãƒ‰ãƒ«ãŒã‚ã£ãŸã®ã§ä¸€ç·’ã«ã„ã£ãŸã²ã¨ã¸ã‚ªã‚¹ã‚¹ãƒ¡ã—ã¦ãŸã‚Šã—ãŸã€‚</p>

<h3 id="the-future-vision-of-ruby-parser"><a href="https://rubykaigi.org/2023/presentations/spikeolaf.html#day1">The future vision of Ruby Parser</a></h3>

<p>ã‚³ãƒŸãƒƒã‚¿ãƒ¼ã® <a href="https://twitter.com/spikeolaf">spikelaf</a> ã•ã‚“ã«ã‚ˆã‚‹ãƒ‘ãƒ¼ã‚µãƒ¼ã®é–‹ç™ºè©±ã€‚é­”çªŸã˜ã‚ƒãªã„ã‚ˆãƒ¼ãªã‚“ã‹ã„ã£ã¦ã¾ã„ã¾ã—ãŸãŒã€é›£ã—ã„å•é¡Œã‚’ä¸å¯§ã«ã²ã¨ã¤ã²ã¨ã¤å€’ã—ã¦ã„ã£ãŸè©±ã‚’ã—ã¦ã„ã¾ã—ãŸã€‚</p>

<h3 id="make-regexpmatch-much-faster"><a href="https://rubykaigi.org/2023/presentations/makenowjust.html#day1">Make Regexp#match much faster</a></h3>

<p>å»å¹´ <a href="https://www.ruby-lang.org/ja/news/2023/03/30/redos-in-time-cve-2023-28756/">ReDoS</a> ã®å¯¾å¿œã‚’ã—ãŸã‚³ãƒŸãƒƒã‚¿ãƒ¼ã®ç™ºè¡¨ã€‚æ­£è¦è¡¨ç¾ã®å¯èƒ½æ€§ã‚’è©±ã—ã¦ãã‚Œã¦ã„ã¾ã™ã€‚</p>

<h3 id="high-performance-real-time-3d-graphics-with-vulkan"><a href="https://rubykaigi.org/2023/presentations/fredolinhares.html#day1">High-performance real-time 3D graphics with Vulkan</a></h3>

<p><a href="https://www.vulkan.org/">Valkan</a> ã‚’ Ruby ã§åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ãŸè©±ã€‚ã“ã®ã‚ãŸã‚Šã¯ LT ã¸ã®ç·Šå¼µæ„Ÿã§ã»ã¨ã‚“ã©è¦šãˆã¦ã„ãªã„ã§ã™ã€‚</p>

<h3 id="power-up-your-repl-life-with-types"><a href="https://rubykaigi.org/2023/presentations/tompng.html#day1">Power up your REPL life with types</a></h3>

<p>å»å¹´ã® <a href="https://github.com/tric/trick2022/blob/master/01-tompng/entry.rb">TRICK Winner</a> ã§ä»Šå›ã®è©±ã¯ <code class="language-plaintext highlighter-rouge">irb</code> ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ã¨ãã«ã©ã†ã„ã†æ„Ÿã˜ã§è£œå®ŒãŒå‡ºã‚‹ã®ã‹ã€å‡ºã™ãŸã‚ã«ã©ã®ã‚ˆã†ãªå‹æ¨è«–ã‚’è¡Œãªã£ã¦ã„ã‚‹ã®ã‹ã®è©±ã ã£ãŸã¨ãŠã‚‚ã†ã€‚</p>

<h3 id="lt">LT</h3>

<p>ã—ã‚ƒã¹ã£ãŸ</p>

<h3 id="ã‚ªãƒ•ã‚£ã‚·ãƒ£ãƒ«ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼">ã‚ªãƒ•ã‚£ã‚·ãƒ£ãƒ«ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼</h3>

<p>ã¤ã‹ã‚ŒãŸã®ã§ãã“ãã“ã§å¸°ã£ãŸ</p>

<h2 id="day-2">Day 2</h2>

<p>æœé£¯ã¯ <a href="https://tabelog.com/nagano/A2002/A200201/20020720/">çˆç²èŒ¶æˆ¿ã‹ã‚ã®ã‚„</a> ã¸ã€‚ã“ã“ã‚‚ãƒ¯ãƒ³ã‚ªãƒšã§é…è†³ã•ã‚Œã‚‹ã¾ã§å°‘ã—æ™‚é–“ãŒã‹ã‹ã£ãŸã€‚ã¨ã„ã†ã‹ã€æœé£Ÿã¹ãã‚‹ã²ã¨ã„ãªã„ã®ã‹ã©ã“ã‚‚ãƒ¯ãƒ³ã‚ªãƒšã ã£ãŸã®ã§ Day 3 ã‚‚æ—©ã‚ã«å‡ºã‚‹ã‚ˆã†ã«ã—ã‚ˆã†ã¨ãªã£ãŸã€‚</p>

<h3 id="on-ruby-and-ê©duÑ-or-how-scary-are-trojan-source-attacks"><a href="https://rubykaigi.org/2023/presentations/duerst.html#day2">On Ruby and ê©duĞ¯, or How Scary are Trojan Source Attacks</a></h3>

<p>æ˜”ä»–ã®è¨€èªã§è©±é¡Œã«ãªã£ãŸ Ruby ã®ã‚³ãƒ¼ãƒ‰çš„ã«ã¯æ­£ã—ã„ãŒã€è¦‹ãŸç›®ã§ã¯ã‚ã‹ã‚‰ãªã„
ä¸æ­£ãªæ–‡å­—ãŒå…¥ã£ãŸã¨ãã®å¯¾ç­–ã®ã¯ãªã—ã§ã—ãŸã€‚</p>

<h3 id="build-a-mini-ruby-debugger-in-under-300-lines"><a href="https://rubykaigi.org/2023/presentations/_st0012.html#day2">Build a mini Ruby debugger in under 300 lines</a></h3>

<p>300 è¡Œã¨ã„ã£ãŸãªã‚ã‚Œã¯å˜˜ã ã€‚ã¨ã„ã†è©±ã€‚Ruby ã® Debugger ã‚’200 è¡Œãã‚‰ã„ã§ã¤ãã£ãŸã¯ãªã—ã§ã—ãŸã€‚</p>

<h3 id="æ˜¼é£¯-1">æ˜¼é£¯</h3>

<p><a href="https://tabelog.com/nagano/A2002/A200201/20015852/">ç¨®æ‘</a> ã§è•éº¦ã¨å²©é­šã¨æ—¥æœ¬é…’ã€‚</p>

<h3 id="revisiting-typeprof---ide-support-as-a-primary-feature"><a href="https://rubykaigi.org/2023/presentations/mametter.html#day2">Revisiting TypeProf - IDE support as a primary feature</a></h3>

<p>Ruby ã«æ¢±åŒ…ã•ã‚Œã¦ã„ã‚‹ <a href="https://github.com/ruby/typeprof/blob/master/doc/doc.ja.md"><code class="language-plaintext highlighter-rouge">TypeProf</code></a> ãŒé…ã„ã®ã§é€Ÿãã—ã¦ã€ã¾ãŸæ›¸ã„ã¦ã„ã‚‹é€”ä¸­ã§ã‚‚ã‚¨ãƒ©ãƒ¼ãŒã§ãŸã¨ãã©ã†ã™ã‚‹ã‹ã¨ã‹ã®èª¬æ˜ã‚’ã—ã¦ã„ã¾ã—ãŸã€‚ã¾ã åˆ©ç”¨ã§ãã¦ã„ãªã„ã®ã§è©¦ã—ãŸããªã‚‹ã‚‚ã®ã ã£ãŸã€‚</p>

<h3 id="ruby-implementation-of-quic-progress-and-challenges"><a href="https://rubykaigi.org/2023/presentations/yu_suke1994.html#day2">Ruby Implementation of QUIC: Progress and Challenges</a></h3>

<p><a href="https://twitter.com/yu_suke1994">Unasuke</a> å¤§å…ˆç”Ÿã®ãƒ©ã‚¤ãƒ•ãƒ¯ãƒ¼ã‚¯ã€ Ruby ã® <a href="https://datatracker.ietf.org/doc/html/rfc9000">QUIC</a> å¯¾å¿œã®ã¯ãªã—ã€‚Python ã§ã®å®Ÿè£…ã¯ã©ã†ã¨ã‹ã®ã¯ãªã—ã§ä»Šå›ã¯å®Ÿè£…ãŒã™ã™ã‚“ã§ã„ã‚‹ã‚ˆã†ã§ã‚ˆã‹ã£ãŸã€‚ã¨ã¯ã„ãˆé“ç¨‹ã¯ã¾ã ã¾ã ã‹ã‹ã‚Šãã†ã€‚</p>

<h3 id="afternoon-break">afternoon break</h3>

<p>ãŠæ˜¼ä¼‘æ†©å¾Œã¯ Jeremy Evans ã‚„ Maxime ã®è©±ã‚’èã„ã¦ã„ãŸãŒç–²ã‚Œã¦ãªã«ã‚‚è¦šãˆã¦ã„ãªã„ã€‚</p>

<h3 id="leaner-drinkup-at-rubykaigi-2023"><a href="https://leanertechnologies.connpass.com/event/280191/">Leaner Drinkup at RubyKaigi 2023</a></h3>

<p>ã“ã®æ—¥ã¯ <a href="https://leaner.jp/">Leaner</a> ã•ã‚“ä¸»å‚¬ã® drinkup ã¸è¡Œãã¾ã—ãŸã€‚ã“ã“ã§ã¯ä¸»ã«æ—¥æœ¬ã‚’é£²ã‚“ã§ã™ã”ã—ã¾ã—ãŸã€‚ã§ã“ã“ã§ã€spikelaf ãŒ kaigi ã§ã‚‚è©±ã—ã¦ãŸ <a href="https://github.com/ruby/lrama">lrama</a> ãŒ Ruby æœ¬ä½“ã®ã¨ã‚Šã“ã¾ã‚Œã€ <a href="https://www.ruby-lang.org/ja/news/2023/05/12/ruby-3-3-0-preview1-released/">Ruby 3.3.0-preview1 ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸ</a>!ãªã‚“ã‹ã•ã‚ã„ã§ã‚‹ãªã¨æ€ãŸã‚‰ãƒªãƒªãƒ¼ã‚¹ä½œæ¥­ã‚·ãƒ†ã‚¤ã‚¿ãƒˆãƒâ€¦
drinkup çµ‚äº†å¾Œã¯ <a href="https://twitter.com/onk">onk</a> ã¨ãµãŸã‚Šã§è¿‘æ‰€ã®ãƒ¯ã‚¤ãƒ³ãƒãƒ¼ã¸è¡Œãã€è»½ãã®ã‚“ã§å®¿ã¸å¸°ã‚Šã¾ã—ãŸã€‚</p>

<p>å®¿å¸°ã£ãŸã‚‰ <a href="https://esm.co.jp/">ESM</a> ã•ã‚“ã®ãƒãƒ™ãƒªãƒ†ã‚£ã® <a href="https://blog.agile.esm.co.jp/entry/ruby-method-karuta">Rubyãƒ¡ã‚½ãƒƒãƒ‰ã‹ã‚‹ãŸ</a> ã§ã¿ã‚“ãªã§ã‚ã„ã‚ã„ã—ãªãŒã‚‰éŠã‚“ã§ã¾ã—ãŸã€‚</p>

<h2 id="day-3">Day 3</h2>

<p>ã“ã®æ—¥ã®æœé£Ÿã¯ <a href="https://tabelog.com/nagano/A2002/A200201/20023046">å±±å±±é£Ÿå ‚</a> ã¨ã„ã†ã¨ã“ã‚ã§ã—ã¾ã—ãŸã€‚</p>

<h3 id="committers-and-the-worldã®ã‚ã¨">Committers and the Worldã®ã‚ã¨</h3>

<p>ä»Šå›ã¯ Matzæœ¬ ã¨ã„ã†ã“ã¨ã§ä¼šå ´ã«ã„ã‚‹ã€Œã¾ã¤ã‚‚ã¨ã•ã‚“ã€ä¸€åŒä¼šã—ã¦å†™çœŸã‚’æ’®ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã‚ã¤ã‚ã¦ã¾ã—ãŸã€‚å†™çœŸã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™</p>

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">æ¾æœ¬ã•ã‚“å¤§é›†åˆã«ã€å½“ç¤¾ã®æ¾æœ¬ã•ã‚“ã‚‚æ··ãœã¦ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã£ğŸ¯<a href="https://twitter.com/hashtag/RubyKaigi2023?src=hash&amp;ref_src=twsrc%5Etfw">#RubyKaigi2023</a> <a href="https://t.co/neYYer5e2A">pic.twitter.com/neYYer5e2A</a></p>&mdash; Yasunori Suzuki (@yasuzukisan) <a href="https://twitter.com/yasuzukisan/status/1657253330056519680?ref_src=twsrc%5Etfw">May 13, 2023</a></blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<h3 id="ruby--adbc---a-single-api-between-ruby-and-dbs"><a href="https://rubykaigi.org/2023/presentations/ktou.html#day3">Ruby + ADBC - A single API between Ruby and DBs</a></h3>

<p><a href="https://github.com/kou">é ˆè—¤ã•ã‚“</a> ã®ç™ºè¡¨ã§ã€ <a href="https://arrow.apache.org/docs/format/ADBC.html"><code class="language-plaintext highlighter-rouge">ADBC</code></a> ã§ DB ã¸æ¥ç¶šã—ã€ã•ã‚‰ã®ãã®æ¥ç¶šã‹ã‚‰ã®ã‚ˆã¿ã‹ãã®é«˜é€ŸåŒ–ã®ã¯ãªã—ã§ã—ãŸã€‚ã‚ã„ã‹ã‚ã‚‰ãšã™ã”ã„ãªã¨æ€ã„ãªãŒã‚‰èã„ã¦ã„ã¾ã—ãŸã€‚</p>

<h3 id="ruby-jit-hacking-guide"><a href="https://rubykaigi.org/2023/presentations/k0kubun.html#day3">Ruby JIT Hacking Guide</a></h3>

<p><a href="https://github.com/k0kubun">å›½åˆ†ã•ã‚“</a> ã®æ–°ä½œ <a href="https://github.com/ruby/ruby/pull/7448">RubyJIT</a>ã€‚PRã¿ãŸæ„Ÿã˜ã ã¨ã‚„ã£ã¦ã‚‹ãƒã‚¿ã«ã¦ã‚‹ãªã‚ã¨ãŠã‚‚ã£ã¦ãŸã‘ã©ã€ã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒã™ã“ã—é•ã„ã€ã¾ãŸã“ã¡ã‚‰ã¯ç›´æ¥ELFã‚’æ›¸ã„ã¦ã„ã‚‹ã‚ˆã†ãªã®ã§ã¾ã ã¡ãŒã†ã‚ˆã†ã ã€‚ã¨ã¯ã„ãˆä»Šã‚„ã£ã¦ã„ã‚‹ã“ã¨ã¯ä¼¼ã¦ã„ã‚‹ã®ã§ã‚ã¨ã§å‚è€ƒã«ã—ã‚ˆã†ã€‚</p>

<h3 id="after-party-and-music-mixin">After Party and Music Mixin</h3>

<p><a href="https://stores.jp/">STORESã•ã‚“</a> ã® <a href="https://hey.connpass.com/event/277763/">ã‚¢ãƒ•ã‚¿ãƒ¼ãƒ‘ãƒ†ã‚£ãƒ¼</a> ã¨ <a href="https://www.pixiv.net">pixivã•ã‚“</a> ã® <a href="https://conference.pixiv.co.jp/2023/rubymusicmixin">ruby music mixin</a> ã«ã„ã£ã¦ãã¾ã—ãŸã€‚ä¸¡æ–¹ã¨ã‚‚ã‚µã‚¤ã‚³ãƒ¼ã§ã—ãŸ!!!!</p>

<h2 id="day-4">Day 4</h2>

<p>ä¸€äººã§é‡æ²¢æ¸©æ³‰æ‘ã„ã£ã¦æ¸©æ³‰ã¯ã„ã£ã¦ã€ã‚¸ãƒ³ã®ã‚“ã§ã€ãƒ“ãƒ¼ãƒ«ã®ã¿ã„ã“ã†ã¨ä¸€æ—¦å±±ãŠã‚ŠãŸã‚‰æ¸©æ³‰ã«ã—ã‹é£²ã‚€ã¨ã“ãªã‹ã£ãŸã®ã§ã‚‚ã©ã£ãŸã‚Šã—ã¦å¸°ã‚Šã¾ã—ãŸã€‚</p>

<h2 id="ãŠã‚ã‚Š">ãŠã‚ã‚Š</h2>

<p>ä»Šå›ã®RubyKaigiä¹…ã—ã¶ã‚Šã®Fullé–‹å‚¬ã§å¤§å¤‰æ¥½ã—ã‚ãŸã®ã§ã™ãŒã€LTã¨ã¯è¨€ãˆã¯ã˜ã‚ã¦ã®ç™ºè¡¨ãŒã‚ã‚Šã€å¿ƒã‹ã‚‰æ¥½ã—ã‚ãŸã‹ã¨ã„ã†ã¨ã‚ã‚Œã§ã™ãŒã€ã™ã”ãæ¥½ã—ã‹ã£ãŸã—ã€åˆºæ¿€ã«ãªã‚Šã¾ã—ãŸã€‚æ¥å¹´ã®é‚£è¦‡ã¯æœ¬ç·¨ã«å‡ºã›ã‚‹ã‚ˆã†ã«ãªã‚“ã¨ã‹ç²¾é€²ã—ã¾ã™!!!</p>

<hr />

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:sonnnakotohanai" role="doc-endnote">
      <p>æµ·å¤–ã®äººãŒç™»éŒ²ã—ã¦è¡Œã£ãŸã»ã†ãŒã„ã„ã‚“ã˜ã‚ƒãªã„ã‹ã¨ä¸€ç¬æ€ã£ãŸÂ <a href="#fnref:sonnnakotohanai" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

  </div>

  <h1><a href="/blog/2023/03/21/my-hobby-is-building-vaporware/">è¶£å‘³ã¯ vaporware é€ ã‚Šã§ã™v0.0.0</a></h1>
  <p class="author">
    <span class="date">2023-03-21 13:59:59 +0900</span>
  </p>
  <div class="content">
    <p>ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ä¸‰å¤§å‹‰å¼·ã¯ã—ãŸã‘ã©ã€å®Ÿè£…ã¯ã—ãŸã“ã¨ãªã„ã‚‚ã®ã¨ã„ãˆã°
CPUã€OSã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ¼ãªã®ã§ã™<sup id="fnref:kojinsa" role="doc-noteref"><a href="#fn:kojinsa" class="footnote" rel="footnote">1</a></sup>ãŒã€å…ˆæ—¥ <a href="https://www.publickey1.jp/blog/23/ruby30static_compiler_for_ruby.html">ruby30th èª•ç”Ÿæ—¥ä¼šã®ã‚­ãƒ¼ãƒãƒ¼ãƒˆ</a>ã§
matz ãŒ â€œStatic Compiler for Rubyâ€ ã¨ã„ã†ä»Šã¯ã¾ã ãªã„ <code class="language-plaintext highlighter-rouge">vaporware</code> ã¨ã—ã¦
æŒ™ã’ã¦ã„ãŸã®ã§ã“ã® <strong>static compiler</strong> ã‚’ä½œã‚ã†ã¨ãªã‚Šã¾ã—ãŸã€‚</p>

<p><a href="https://github.com/katsyoshi/vaporware"><img src="https://gh-card.dev/repos/katsyoshi/vaporware.svg" alt="katsyoshi/vaporware - GitHub" /></a></p>

<h2 id="goal">Goal</h2>

<p><strong>Ruby</strong> ã®ã‚³ãƒ¼ãƒ‰ã‚’ <strong>static compile</strong> ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚</p>

<p>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å…ˆã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¯ <strong>x86</strong> ã¨ã—ã¾ã™ã€‚ <strong>ARM</strong> ã‚„ <strong>RISC-V</strong> ãªã©ã¯ä»Šå›ã®å®Ÿè£…ã§ã¯ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ã—ãªã„ã§ã™ã€‚</p>

<p>ã¨ã¯ã„ãˆã™ã¹ã¦ã® <strong>Ruby</strong> ã®æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ã¨æ™‚é–“ãŒã‹ã‹ã‚Šã™ãã‚‹ã®ã§å€‹äººã§ç„¡ç†ã®ãªã„ç¯„å›²
ã§ä½œã‚ã†ã¨ã—ã¾ã™ã€‚ç„¡ç†ã®ãªã„å®Ÿè£…ç¯„å›²ã¯ä»¥ä¸‹ãªã®ã‹ãªã¨</p>

<ol>
  <li>å››å‰‡æ¼”ç®—</li>
  <li>å¤‰æ•°</li>
  <li>ãƒ¡ã‚½ãƒƒãƒ‰</li>
  <li>åˆ¶å¾¡æ§‹æ–‡</li>
  <li>ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹</li>
</ol>

<p>ã“ã®5ã¤ã®æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹äºˆå®šã§ã™ã€‚</p>

<h3 id="å®Ÿç¾ã™ã‚‹æ©Ÿèƒ½ä»¥å¤–ã®ã“ã¨ã«ã¤ã„ã¦">å®Ÿç¾ã™ã‚‹æ©Ÿèƒ½ä»¥å¤–ã®ã“ã¨ã«ã¤ã„ã¦</h3>

<p>5ã¤ã®æ©Ÿèƒ½ã‚’å®Ÿç¾ã™ã‚‹ã“ã¨ä»¥ä¸Šã®ã“ã¨ã¯ã‚„ã‚‰ãªã„äºˆå®šã§ã™ã€‚
ã‚„ã‚‰ãªã„ã“ã¨ã¨ã—ã¦ã¯ <em>æœ€é©åŒ–</em> ã€ <em>GC</em> ã€ å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã§å®šç¾©ã—ãŸãƒ¡ã‚½ãƒƒãƒ‰ã‚„ã‚¯ãƒ©ã‚¹ã®èª­ã¿è¾¼ã¿ã¯å®Ÿè£…ã—ãªã„äºˆå®šã§ã™ã€‚
å®Ÿè£…ã—ãªã„å€‹äººçš„æ„è¦‹ã‚’ä»¥ä¸‹ã«æ›¸ã„ã¦ã„ãã¾ã™ã€‚</p>

<p>æœ€é©åŒ–ã¯ <strong>Ruby</strong> ã®ã‚³ãƒ¼ãƒ‰ã‚’å˜ç´”ã« <em>æ©Ÿæ¢°èª</em> ã«ãŠã¨ã—ãŸã ã‘ã§ã¯ç¾åœ¨ã® <strong>RubyVM</strong>
ã‚ˆã‚Šé€Ÿããªã‚‰ãªã„ã¨è€ƒãˆã¦ã„ã‚‹ã‹ã‚‰ã§ã™(è¦ç¢ºèª)ã€‚
<strong>LLVM IR</strong> ãªã©ã¸ã®å¤‰æ›ã§ã¯ãªãã€ <em>æ©Ÿæ¢°èª</em> ãªã®ã¯ <strong>LLVM</strong> ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãªã©ã—ã¦
é¢å€’ãªã®ãŒå¤§ãã„ã§ã™<sup id="fnref:gentoo" role="doc-noteref"><a href="#fn:gentoo" class="footnote" rel="footnote">2</a></sup>ã€‚ã‚ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ¯ã« <strong>LLVM IR</strong> ãŒç•°ãªã‚‹ã®ã‚‚ç¾çŠ¶ã§ã¯å¯¾å¿œã—ã«ãã„ç‚¹ã¨ãªã£ã¦ã„ã¾ã™ã€‚</p>

<p><em>GC</em> (Garbage Collection: ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³) ã«ã¤ã„ã¦ã¯ãã‚‚ãã‚‚ã‚¯ãƒ©ã‚¹ã‚’ã‚µãƒãƒ¼ãƒˆã§ããªã„ã€
å¤‰æ•°ãªã©ã®ãƒ¡ãƒ¢ãƒªã‚’ç¢ºä¿ã—ã¦ãŠãæ™‚é–“ãŒé•·ã„ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å¯¾è±¡ã¨ã—ãªã„ã®ã§ä»Šå›ã¯ã‚¹ã‚³ãƒ¼ãƒ—å¤–ã¨ã—ã¦ã„ã¾ã™ã€‚</p>

<p>å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã«ã¤ã„ã¦ã§ã™ãŒã€å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã—ã¦ <em>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«</em> ã™ã‚‹ã ã‘ãªã‚‰
ãã“ã¾ã§å•é¡Œã«ã¯ãªã‚‰ãªã„ã¨è€ƒãˆã¦ã„ã¾ã™ãŒã€å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã§å®šç¾©ã•ã‚ŒãŸ <em>ãƒ¡ã‚½ãƒƒãƒ‰</em> ã‚„ <em>ã‚¯ãƒ©ã‚¹</em> ã‚’
äº‹å‰ã« <em>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«</em> ã—ã¦æœ€å¾Œã« <em>ãƒªãƒ³ã‚¯</em> ã™ã‚‹ã®ã¯å‹ãŒä¸å®šã«ãªã‚‹ã®ã§ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã®ã¯é›£ã—ã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚</p>

<h2 id="å®Ÿè£…æ–¹é‡">å®Ÿè£…æ–¹é‡</h2>
<p>Goal ã¾ã§ã®å®Ÿè£…ã¯ <a href="https://www.sigbus.info/compilerbook">ä½ãƒ¬ã‚¤ãƒ¤ã‚’çŸ¥ã‚ŠãŸã„äººã®ãŸã‚ã®Cã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ä½œæˆå…¥é–€</a> ã‚’å‚è€ƒã«ã™ã™ã‚ã¦ã„ãã¾ã™ã€‚
æœ€åˆã« <em>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ¼</em> ã‚’å®Ÿè£…ã™ã‚‹ã‚‚ã®ã¨ã—ã¦ <em>C è¨€èª</em> ãŒãŸã¶ã‚“å‹‰å¼·ã—ã¦ãã¦ã†ã‹ã¶ã¨æ€ã„ã¾ã™<sup id="fnref:java" role="doc-noteref"><a href="#fn:java" class="footnote" rel="footnote">3</a></sup>ã€‚
<em>C è¨€èª</em> ã ã¨ <em>æ©Ÿæ¢°èª</em> ã‚„ <em>VM</em> ã®ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ã¸è½ã¨ã™ã“ã¨ã®ã§ãã‚‹è³‡æ–™ãŒå¤šã„ã®ã§é¸æŠã—ã¦ã„ã¾ã™ã€‚
ã¨ã¯è¨€ã£ã¦ã‚‚ <strong>Ruby</strong> ã‹ã‚‰ã®è„³å†…å¤‰æ›ã¯ã‚ã‚‹ç¨‹åº¦å¿…è¦ãªã®ã§æ…£ã‚Œã¦ã„ã‚‹ã¨ã„ã†ã®ã‚‚ã‚ã‚Šã¾ã™ã€‚</p>

<p>å®Ÿè£…ã¨ã—ã¦ã¯ <em>AST</em>(Abstract Syntax Tree: æ§‹æ–‡æŠ½è±¡æœ¨) ã‹ã‚‰æ„šç›´ã« <strong>x86 ã‚¢ã‚»ãƒ³ãƒ–ãƒ©</strong> ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã¸æ›¸ãå‡ºã—ã€
ãã“ã‹ã‚‰ <em>C ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ¼</em> (<code class="language-plaintext highlighter-rouge">gcc</code> or <code class="language-plaintext highlighter-rouge">clang</code>) ã‚’ã¤ã‹ã£ã¦æ©Ÿæ¢°èªã¸ <em>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«</em> ã—ã¾ã™ã€‚
ãƒ•ãƒ«ãƒ•ãƒ«ã® <strong>Ruby</strong> ã‚’å®Ÿè£…ã™ã‚‹ã‚ã‘ã˜ã‚ƒãªã„ã®ã§ä¾å­˜ã™ã‚‹ <strong>gem</strong> ã®ä¾å­˜ã‚‚æ¥µåŠ›æ¸›ã‚‰ã—ãŸã„ã§ã™ã€‚</p>

<h3 id="å®Ÿè£…ç’°å¢ƒ">å®Ÿè£…ç’°å¢ƒ</h3>

<ul>
  <li>CPU: Ryzen Thread Ripper 1950x</li>
  <li>gcc: 12.2.1</li>
  <li>clang: 16.0.0</li>
  <li>OS: Gentoo Linux</li>
  <li>Linux Kernel: 6.2 ç³»</li>
</ul>

<h2 id="ãƒ‘ãƒ¼ã‚µãƒ¼">ãƒ‘ãƒ¼ã‚µãƒ¼</h2>

<p>ã¾ãšã€<em>AST</em> ã‚’å¾—ã‚‹ãŸã‚ã« <em>ãƒ‘ãƒ¼ã‚µãƒ¼</em> ãŒå¿…è¦ãªã®ã§ã™ãŒã€ <strong>Ruby</strong> ã®æ§‹æ–‡ã¯è¤‡é›‘ãªã®ã§ã“ã“ã¯é ‘å¼µã‚‰ãªã„ã‚ˆã†ã«ã—ã¾ã™ã€‚ã“ã“ã‚’ã©ã†ã‚„ã£ã¦è§£æ±ºã™ã‚‹ã®ã‹ã¨ã„ã†ã¨ <code class="language-plaintext highlighter-rouge">RubyVM::AbstractSyntaxTree</code> ã‚„ <code class="language-plaintext highlighter-rouge">Ripper</code> ã‚’ã¤ã‹ã†ã®ã‹ã€<code class="language-plaintext highlighter-rouge">parser.gem</code> ã‚’ã¤ã‹ã†ã®ã‹ã‚’æ±ºã‚ã‚‹ã²ã¤ã‚ˆã†ãŒã‚ã‚Šã¾ã™ã€‚ä»Šå›ã¨ã„ã†ã‹ã—ã°ã‚‰ãã¯ <code class="language-plaintext highlighter-rouge">parser.gem</code> ã‚’åˆ©ç”¨ã—ã¦ <em>AST</em> ã‚’å¾—ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚
ã‚†ãã‚†ãã¯ <code class="language-plaintext highlighter-rouge">RubyVM::AbstractSyntaxTree</code> ã¸ã®ç½®ãæ›¿ãˆã¯ã™ã‚‹ã‚ˆã¦ã„ã§ã™ã€‚</p>

<p>ã“ã“ã¯ãã®ã¾ã¾ <code class="language-plaintext highlighter-rouge">parser.gem</code> ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã©ãŠã‚Šã«ã™ã‚Œã° <em>AST</em> ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">require</span> <span class="s2">"parser/current"</span>

<span class="nb">puts</span> <span class="no">Parser</span><span class="o">::</span><span class="no">CurrentRuby</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s2">"(1 + 2) * 3 / (5 - 4)"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="ãã‚‡ã†ã¯ã“ã“ã¾ã§">ãã‚‡ã†ã¯ã“ã“ã¾ã§</h2>

<p>ã¨ã‚Šã‚ãˆãšæ‰‹ã‚’å‹•ã‹ã—ã¯ã˜ã‚ã¾ã—ãŸãŒã€ãªãªãªãªã‚“ã¨ã€ä¼¼ãŸã‚ˆã†ãªæ©Ÿèƒ½ãŒå®Ÿã¯ <strong>Ruby 3.3</strong> å‘ã‘ã«
<em>JIT</em> ã¨ã—ã¦å…¥ã£ãŸã‚ˆã†ã§ã™<sup id="fnref:rjit" role="doc-noteref"><a href="#fn:rjit" class="footnote" rel="footnote">4</a></sup>ã€‚
ã¨ã„ã†ã“ã¨ã§ã­ã“ã®è©±ã¯ã­ã€å‹‰å¼·ã®è©±ã—ã‹ãªã„ã‚“ã§ã™ãŒä¸€æ—¦ Goal ã¾ã§ä½œã£ã¦ã¿ã¾ã—ã‚‡ã†ã­ã€‚</p>

<hr />

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:kojinsa" role="doc-endnote">
      <p>å€‹äººå·®ãŒã‚ã‚Šã¾ã™ã€‚Â <a href="#fnref:kojinsa" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:gentoo" role="doc-endnote">
      <p>Gentoo Linux ä½¿ã£ã¦ã„ã‚‹ã®ã§æ¯å›ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ã„ã‚‹ã®ã§æœ¬å½“ã«ã‚ã‚“ã©ã†ã€‚ãƒã‚¤ãƒŠãƒªã‚ã‚‹ã‚ˆã¨ã‹ãã†ã„ã†æ­£è«–ã¯å—ã‘ä»˜ã‘ã¦ã„ãªã„ã§ã™ã€‚Â <a href="#fnref:gentoo" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:java" role="doc-endnote">
      <p>æ™‚ä»£ã«ã‚ˆã£ã¦å¤‰ã‚ã‚‹ã‹ã‚‚ã€‚<strong>Java</strong> ã ã£ãŸã‚Šã€<strong>Lisp</strong> ã ã£ãŸã‚Šã™ã‚‹äººãŒã„ã‚‹ã‹ã‚‚ã€‚Â <a href="#fnref:java" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:rjit" role="doc-endnote">
      <p>https://github.com/ruby/ruby/pull/7448Â <a href="#fnref:rjit" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

  </div>

  <h1><a href="/blog/2023/01/03/upgrade-gems-using-rust-for-new-rubygems/">Update rubygems using Rust for Ruby 3.2</a></h1>
  <p class="author">
    <span class="date">2023-01-03 23:59:59 +0900</span>
  </p>
  <div class="content">
    <p><a href="/blog/2022/08/12/how-to-use-rust-in-ruby-gems/">ä»¥å‰ã“ã®ãƒ–ãƒ­ã‚°</a>ã§ <a href="https://www.rust-lang.org/"><strong>Rust</strong></a> ã‚’åˆ©ç”¨ã—ã¦ <a href="https://rubygems.org"><strong>rubygems</strong></a> ã‚’ä½œæˆã—ãŸ
<a href="https://github.com/katsyoshi/rust_uuid"><strong>rust_uuid</strong></a> ãŒ <a href="https://www.ruby-lang.org/ja/news/2022/12/25/ruby-3-2-0-released/"><strong>Ruby 3.2</strong> ãŒãƒªãƒªãƒ¼ã‚¹</a> ã«ã‚ˆã‚Šã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ããªããªã£ãŸã®ã§ãã®ä¿®æ­£é¡›æœ«ã€‚</p>

<h2 id="ç’°å¢ƒ">ç’°å¢ƒ</h2>

<table>
  <thead>
    <tr>
      <th>system</th>
      <th>failed version</th>
      <th>succeed version</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ruby</td>
      <td>3.2.0</td>
      <td>3.2.0</td>
    </tr>
    <tr>
      <td>gem</td>
      <td>3.4.1</td>
      <td>3.4.2</td>
    </tr>
    <tr>
      <td>bundler</td>
      <td>2.3.19</td>
      <td>2.4.2</td>
    </tr>
    <tr>
      <td>rb-sys</td>
      <td>0.9.29</td>
      <td>0.9.53</td>
    </tr>
    <tr>
      <td>magnus</td>
      <td>0.3.2</td>
      <td>0.4.4</td>
    </tr>
  </tbody>
</table>

<h2 id="whats-happened">whatâ€™s happened?</h2>

<p><strong>Ruby 3.2</strong> ãŒå‡ºã¦ãŸã®ã§ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ã¦è©¦ã—ã¦ã¿ã‚‹ã‹ãƒ¼ã¨ãŠã‚‚ã„ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ!!!!</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bundle <span class="nb">exec </span>rake build
<span class="nb">.</span>
<span class="nb">.</span>
...
error[E0425]: cannot find value <span class="sb">`</span>RUBY_ABI_VERSION<span class="sb">`</span> <span class="k">in </span>the crate root
  <span class="nt">--</span><span class="o">&gt;</span> /path/to/cargo/dir/registry/src/github.com-1ecc6299db9ec823/rb-sys-0.9.29/src/ruby_abi_version.rs:14:73
   |
14 | pub const __RB_SYS_RUBY_ABI_VERSION: std::os::raw::c_ulonglong <span class="o">=</span> crate::RUBY_ABI_VERSION as _<span class="p">;</span>
   |                                                                         ^^^^^^^^^^^^^^^^ not found <span class="k">in </span>the crate root

For more information about this error, try <span class="sb">`</span>rustc <span class="nt">--explain</span> E0425<span class="sb">`</span><span class="nb">.</span>
error: could not compile <span class="sb">`</span>rb-sys<span class="sb">`</span> due to previous error
warning: build failed, waiting <span class="k">for </span>other <span class="nb">jobs </span>to finish...
gmake: <span class="k">***</span> <span class="o">[</span>Makefile:564: target/release/librust_uuid.so] ã‚¨ãƒ©ãƒ¼ 101
rake aborted!
Command failed with status <span class="o">(</span>2<span class="o">)</span>: <span class="o">[</span>/usr/bin/gmake...]
/path/to/rbenv/versions/3.2.0/bin/bundle:25:in <span class="sb">`</span>load<span class="s1">'
/path/to/rbenv/versions/3.2.0/bin/bundle:25:in `&lt;main&gt;'</span>
Tasks: TOP <span class="o">=&gt;</span> build <span class="o">=&gt;</span> compile <span class="o">=&gt;</span> compile:x86_64-linux <span class="o">=&gt;</span> compile:rust_uuid:x86_64-linux <span class="o">=&gt;</span> copy:rust_uuid:x86_64-linux:3.2.0 <span class="o">=&gt;</span> tmp/x86_64-linux/rust_uuid/3.2.0/rust_uuid.so
<span class="o">(</span>See full trace by running task with <span class="nt">--trace</span><span class="o">)</span>
bundle <span class="nb">exec </span>rake build  63.55s user 10.61s system 541% cpu 13.705 total
</code></pre></div></div>

<p>ãŠãƒ¼ãªã‚‹ã»ã©ãªã‚‹ã»ã©ã€ <strong>cargo</strong> ã® <a href="https://github.com/oxidize-rb/rb-sys"><strong>rb-sys</strong></a> ãŒ <strong>Ruby 3.2</strong> ã«å¯¾å¿œã—ã¦ã„ãªã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¤ã‹ã£ã¦ã‚‹ã‚“ã ãªã¨ç†è§£ã€‚<strong>cargo</strong> ã‚’æ›´æ–°ã£ã™ã‚‹ãã„ã€‚</p>

<h2 id="ã†pã ã¦-cargo-ã±ã£ã‘ãƒ¼ã˜">ã†pã ã¦ <strong>cargo</strong> ã±ã£ã‘ãƒ¼ã˜</h2>

<p>ã¨ã„ã†ã“ã¨ã§ <code class="language-plaintext highlighter-rouge">cargo build</code> ãŒé€šã‚‹ã‚ˆã†ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’æ›´æ–°ã™ã‚‹ãã„ã€‚
<strong>cargo</strong> ã‚‚ <strong>bundler</strong> åŒæ§˜ã€ <code class="language-plaintext highlighter-rouge">cargo update</code> ã§ã„ã„æ„Ÿã˜ã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ã¦ãã‚Œã¾ã™ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd </span>ext/rust_uuid
<span class="nv">$ </span>cargo update
<span class="nv">$ </span>cargo build
   Compiling magnus v0.3.2
error[E0432]: unresolved import <span class="sb">`</span>crate::ruby_sys::ruby_rstring_consts<span class="sb">`</span>
  <span class="nt">--</span><span class="o">&gt;</span> /path/to/cargo/dir/registry/src/github.com-1ecc6299db9ec823/magnus-0.3.2/src/r_string.rs:23:47
   |
23 | use crate::ruby_sys::<span class="o">{</span>rb_str_to_interned_str, ruby_rstring_consts::RSTRING_EMBED_LEN_SHIFT<span class="o">}</span><span class="p">;</span>
   |                                               ^^^^^^^^^^^^^^^^^^^ could not find <span class="sb">`</span>ruby_rstring_consts<span class="sb">`</span> <span class="k">in</span> <span class="sb">`</span>ruby_sys<span class="sb">`</span>

error[E0599]: no variant or associated item named <span class="sb">`</span>RSTRING_EMBED_LEN_MASK<span class="sb">`</span> found <span class="k">for </span>enum <span class="sb">`</span>ruby_rstring_flags<span class="sb">`</span> <span class="k">in </span>the current scope
   <span class="nt">--</span><span class="o">&gt;</span> /path/to/cargo/dir/registry/src/github.com-1ecc6299db9ec823/magnus-0.3.2/src/r_string.rs:368:38
    |
368 |             f &amp;<span class="o">=</span> ruby_rstring_flags::RSTRING_EMBED_LEN_MASK as VALUE<span class="p">;</span>
    |                                      ^^^^^^^^^^^^^^^^^^^^^^ variant or associated item not found <span class="k">in</span> <span class="sb">`</span>ruby_rstring_flags<span class="sb">`</span>

error[E0599]: no variant or associated item named <span class="sb">`</span>RSTRING_EMBED_LEN_MASK<span class="sb">`</span> found <span class="k">for </span>enum <span class="sb">`</span>ruby_rstring_flags<span class="sb">`</span> <span class="k">in </span>the current scope
   <span class="nt">--</span><span class="o">&gt;</span> /path/to/cargo/dir/registry/src/github.com-1ecc6299db9ec823/magnus-0.3.2/src/r_string.rs:968:42
    |
968 |                 f &amp;<span class="o">=</span> ruby_rstring_flags::RSTRING_EMBED_LEN_MASK as VALUE<span class="p">;</span>
    |                                          ^^^^^^^^^^^^^^^^^^^^^^ variant or associated item not found <span class="k">in</span> <span class="sb">`</span>ruby_rstring_flags<span class="sb">`</span>

Some errors have detailed explanations: E0432, E0599.
For more information about an error, try <span class="sb">`</span>rustc <span class="nt">--explain</span> E0432<span class="sb">`</span><span class="nb">.</span>
error: could not compile <span class="sb">`</span>magnus<span class="sb">`</span> due to 3 previous errors
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">cargo update</code> ã—ã¾ã—ãŸãŒã€ã‚„ã£ã±ã‚Šé§„ç›®ã§ã—ãŸã­ã€‚ä»Šåº¦ã¯ <a href="https://github.com/matsadler/magnus"><strong>magnus</strong></a> ãŒé§„ç›®ãã†ã€‚
<code class="language-plaintext highlighter-rouge">Cargo.toml</code> ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€ <code class="language-plaintext highlighter-rouge">magnus = { version = "0.3", features = ["rb-sys-interop"] }</code> ã¨æŒ‡å®šã—ã¦ã‚ã‚Šã€ version 0.3 ç³»ãŒé§„ç›®ãã†ã¨ã„ã†ã“ã¨ãŒé¡æ¨ã•ã‚Œã¾ã™ã€‚ã¨ã„ã†ã“ã¨ã§å…¬å¼ãƒšãƒ¼ã‚¸ã‚’è¦‹ã‚‹ã¨æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå‡ºã¦ã„ã‚‹ã®ã§ã“ã¡ã‚‰ã«ã—ã¾ã™ã€‚</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- a/ext/rust_uuid/Cargo.toml
</span><span class="gi">+++ b/ext/rust_uuid/Cargo.toml
</span><span class="p">@@ -10,7 +10,7 @@</span> crate-type = ["cdylib"]
 [dependencies]
 rb-sys = "0.9"
 rb-allocator = "0.9"
<span class="gd">-magnus = { version = "0.3", features = ["rb-sys-interop"] }
</span><span class="gi">+magnus = { version = "0.4", features = ["rb-sys-interop"] }
</span><span class="err">
</span> [dependencies.uuid]
 version = "1.1.2"
</code></pre></div></div>

<p>å†åº¦ãƒ“ãƒ«ãƒ‰!</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>cargo update
<span class="nv">$ </span>cargo build
   Compiling rust_uuid v0.1.0 <span class="o">(</span>/home/katsyoshi/Program/Ruby/rust_uuid/ext/rust_uuid<span class="o">)</span>
    Finished dev <span class="o">[</span>unoptimized + debuginfo] target<span class="o">(</span>s<span class="o">)</span> <span class="k">in </span>0.18s
</code></pre></div></div>

<p>ãŠãŠã£é€šã‚Šã¾ã—ãŸ!ã‚„ã£ãŸã­!</p>

<h2 id="build">build</h2>

<p>ã¨ã„ã†ã“ã¨ <code class="language-plaintext highlighter-rouge">cargo build</code> é€šã£ãŸã®ã§ <code class="language-plaintext highlighter-rouge">gem install</code> ã—ã¾ã—ã‚ˆã†ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd</span> /path/to/rust_uuid
<span class="nv">$ </span>bundle <span class="nb">exec </span>rake build
<span class="nb">cd </span>tmp/x86_64-linux/rust_uuid/3.2.0
/usr/bin/gmake
generating target/release/librust_uuid.so <span class="o">(</span>release<span class="o">)</span>
cargo rustc <span class="nt">--target-dir</span> target <span class="nt">--manifest-path</span> ../../../../ext/rust_uuid/Cargo.toml <span class="nt">--lib</span> <span class="nt">--release</span> <span class="nt">--</span> <span class="nt">-C</span> <span class="nv">linker</span><span class="o">=</span>gcc <span class="nt">-L</span> <span class="nv">native</span><span class="o">=</span>/path/to/rbenv/versions/3.2.0/lib <span class="nt">-L</span> <span class="nv">native</span><span class="o">=</span>/path/to/rbenv/versions/3.2.0/lib <span class="nt">-L</span> <span class="nv">native</span><span class="o">=</span>/home/katsyoshi/.local/lib:-L/home/katsyoshi/.local/lib: <span class="nt">-C</span> link-arg<span class="o">=</span><span class="nt">-lm</span> <span class="nt">-l</span> pthread
   Compiling libc v0.2.139
   Compiling proc-macro2 v1.0.49
   Compiling quote v1.0.23
   Compiling unicode-ident v1.0.6
   Compiling clang-sys v1.4.0
   Compiling regex-syntax v0.6.28
   Compiling syn v1.0.107
   Compiling rb-sys-env v0.1.1
   Compiling libloading v0.7.4
   Compiling nom v7.1.2
   Compiling aho-corasick v0.7.20
   Compiling magnus v0.4.4
   Compiling bindgen v0.60.1
   Compiling getrandom v0.2.8
   Compiling uuid v1.2.2
   Compiling cexpr v0.6.0
   Compiling regex v1.7.0
   Compiling magnus-macros v0.3.0
   Compiling rb-sys-build v0.9.53
   Compiling rb-sys v0.9.53
   Compiling rb-allocator v0.9.6
   Compiling rust_uuid v0.1.0 <span class="o">(</span>/path/to/rust_uuid/ext/rust_uuid<span class="o">)</span>
    Finished release <span class="o">[</span>optimized] target<span class="o">(</span>s<span class="o">)</span> <span class="k">in </span>12.03s
<span class="nb">cd</span> -
<span class="nb">mkdir</span> <span class="nt">-p</span> tmp/x86_64-linux/stage/lib/rust_uuid
/usr/bin/gmake <span class="nb">install </span><span class="nv">target_prefix</span><span class="o">=</span>
generating target/release/librust_uuid.so <span class="o">(</span>release<span class="o">)</span>
cargo rustc <span class="nt">--target-dir</span> target <span class="nt">--manifest-path</span> ../../../../ext/rust_uuid/Cargo.toml <span class="nt">--lib</span> <span class="nt">--release</span> <span class="nt">--</span> <span class="nt">-C</span> <span class="nv">linker</span><span class="o">=</span>gcc <span class="nt">-L</span> <span class="nv">native</span><span class="o">=</span>/path/to/rbenv/versions/3.2.0/lib <span class="nt">-L</span> <span class="nv">native</span><span class="o">=</span>/path/to/rbenv/versions/3.2.0/lib <span class="nt">-L</span> <span class="nv">native</span><span class="o">=</span>/home/katsyoshi/.local/lib:-L/home/katsyoshi/.local/lib: <span class="nt">-C</span> link-arg<span class="o">=</span><span class="nt">-lm</span> <span class="nt">-l</span> pthread
    Finished release <span class="o">[</span>optimized] target<span class="o">(</span>s<span class="o">)</span> <span class="k">in </span>0.02s
installing rust_uuid.so to /path/to/rust_uuid/lib/rust_uuid
/usr/bin/install <span class="nt">-c</span> <span class="nt">-m</span> 0755 rust_uuid.so /path/to/rust_uuid/lib/rust_uuid
<span class="nb">cp </span>tmp/x86_64-linux/rust_uuid/3.2.0/rust_uuid.so tmp/x86_64-linux/stage/lib/rust_uuid/rust_uuid.so
rake aborted!
Running <span class="sb">`</span>gem build <span class="nt">-V</span> /path/to/rust_uuid/rust_uuid.gemspec<span class="sb">`</span> failed with the following output:

WARNING:  description and summary are identical
WARNING:  open-ended dependency on benchmark-ips <span class="o">(&gt;=</span> 0, development<span class="o">)</span> is not recommended
  use a bounded requirement, such as <span class="s1">'~&gt; x.y'</span>
WARNING:  open-ended dependency on rake <span class="o">(&gt;=</span> 13.0.0, development<span class="o">)</span> is not recommended
  <span class="k">if </span>rake is semantically versioned, use:
    add_development_dependency <span class="s1">'rake'</span>, <span class="s1">'~&gt; 13.0'</span>, <span class="s1">'&gt;= 13.0.0'</span>
WARNING:  open-ended dependency on rake-compiler <span class="o">(&gt;=</span> 0, development<span class="o">)</span> is not recommended
  use a bounded requirement, such as <span class="s1">'~&gt; x.y'</span>
WARNING:  open-ended dependency on rb_sys <span class="o">(&gt;=</span> 0, development<span class="o">)</span> is not recommended
  use a bounded requirement, such as <span class="s1">'~&gt; x.y'</span>
WARNING:  open-ended dependency on rspec <span class="o">(&gt;=</span> 0, development<span class="o">)</span> is not recommended
  use a bounded requirement, such as <span class="s1">'~&gt; x.y'</span>
WARNING:  See https://guides.rubygems.org/specification-reference/ <span class="k">for </span><span class="nb">help
</span>ERROR:  While executing gem ... <span class="o">(</span>Gem::InvalidSpecificationException<span class="o">)</span>
    You have specified rust based extension, but Cargo.lock is not part of the gem files. Please run <span class="sb">`</span>cargo generate-lockfile<span class="sb">`</span> or any other <span class="nb">command </span>to generate Cargo.lock and ensure it is added to your gem files section <span class="k">in </span>gemspec.

/path/to/rbenv/versions/3.2.0/bin/bundle:25:in <span class="sb">`</span>load<span class="s1">'
/path/to/rbenv/versions/3.2.0/bin/bundle:25:in `&lt;main&gt;'</span>
Tasks: TOP <span class="o">=&gt;</span> build
<span class="o">(</span>See full trace by running task with <span class="nt">--trace</span><span class="o">)</span>
bundle <span class="nb">exec </span>rake build  32.87s user 4.33s system 291% cpu 12.741 total
</code></pre></div></div>

<p>ãªã‚‹ã»ã©ï¼Ÿ <code class="language-plaintext highlighter-rouge">Cargo.lock</code> ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ã‚ã‚‹ã—å•é¡Œãªã•ãã†ã ãªã€‚ã‚ˆãã‚ã‹ã‚‰ã‚“ã®ã§ <strong>rubygems</strong> ã®ãƒªãƒã‚¸ãƒˆãƒªã§ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ¢ã—ã¦ã¿ã¾ã™ã€‚</p>

<p>ã™ã‚‹ã¨<a href="https://github.com/rubygems/rubygems/blob/05df95280e5f25299f4130a25dc44100226c2235/lib/rubygems/specification_policy.rb#L467-L474">ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰</a>ãŒ</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">validate_rust_extensions</span><span class="p">(</span><span class="n">builder</span><span class="p">)</span> <span class="c1"># :nodoc:</span>
    <span class="n">rust_extension</span> <span class="o">=</span> <span class="vi">@specification</span><span class="p">.</span><span class="nf">extensions</span><span class="p">.</span><span class="nf">any?</span> <span class="p">{</span><span class="o">|</span><span class="n">s</span><span class="o">|</span> <span class="n">builder</span><span class="p">.</span><span class="nf">builder_for</span><span class="p">(</span><span class="n">s</span><span class="p">).</span><span class="nf">is_a?</span> <span class="no">Gem</span><span class="o">::</span><span class="no">Ext</span><span class="o">::</span><span class="no">CargoBuilder</span> <span class="p">}</span>
    <span class="n">missing_cargo_lock</span> <span class="o">=</span> <span class="o">!</span><span class="vi">@specification</span><span class="p">.</span><span class="nf">files</span><span class="p">.</span><span class="nf">include?</span><span class="p">(</span><span class="s2">"Cargo.lock"</span><span class="p">)</span>

    <span class="n">error</span> <span class="o">&lt;&lt;-</span><span class="no">ERROR</span> <span class="k">if</span> <span class="n">rust_extension</span> <span class="o">&amp;&amp;</span> <span class="n">missing_cargo_lock</span><span class="sh">
You have specified rust based extension, but Cargo.lock is not part of the gem files. Please run `cargo generate-lockfile` or any other command to generate Cargo.lock and ensure it is added to your gem files section in gemspec.
</span><span class="no">    ERROR</span>
  <span class="k">end</span>
</code></pre></div></div>

<p>ãªã‚ã»ã©ãªã‚ã»ã©ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® root ç›´ä¸‹ã«ç½®ã„ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã®ã­ã€‚ã§ã‚‚ãã®ãƒ•ã‚¡ã‚¤ãƒ«ã©ã†ã„ã†ã‚‚ã®ãªã®ï¼Ÿ</p>

<h2 id="gem-bundler-update">gem, bundler update</h2>

<p>ã£ã¦ãªã‚ã‘ã§ã€ä»Šåº¦ã¯æ­£å¼ã« <strong>rubygems</strong> ã§æ­£å¼ã«ã‚µãƒãƒ¼ãƒˆã•ã‚Œã€ <strong>bundler</strong> ã§ã‚‚ <strong>gem</strong> ã‚’ä½œæˆã™ã‚‹ã¨ãã«ã‚‚ <code class="language-plaintext highlighter-rouge">bundle gem --ext=rust gem_name</code> ã§<a href="https://github.com/rubygems/rubygems/pull/6149">ã‚¹ã‚±ãƒ«ãƒˆãƒ³ãŒä½œæˆ</a>ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ã¨ã„ã†ã“ã¨ã§ã“ã‚Œã‚’åˆ©ç”¨ã—ã¦ <code class="language-plaintext highlighter-rouge">Cargo.toml</code> ã‚’ä½œã£ã¦ã¿ã¾ã—ã‚‡ã†</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bundle gem <span class="nt">--mit</span> <span class="nt">--ext</span><span class="o">=</span>rust gem_name
ERROR: <span class="s2">"bundle gem"</span> was called with arguments <span class="o">[</span><span class="s2">"rust"</span>, <span class="s2">"gem_name"</span><span class="o">]</span>
Usage: <span class="s2">"bundle gem NAME [OPTIONS]"</span>
</code></pre></div></div>

<p>ok, ok, ã“ã‚Œã¯ <strong>bundler</strong> ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤ã„ãª</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bundle version
Bundler version 2.3.19 <span class="o">(</span>2022-07-27 commit 4f496f93e6<span class="o">)</span>
</code></pre></div></div>

<p>ã•ã£ãã® <strong>PR</strong> ã¯å…¥ã£ãŸã®ã¯ <strong>Ruby 3.2</strong> ãƒªãƒªãƒ¼ã‚¹ç›´å‰ãªã®ã§ã¾ã å…¥ã£ã¦ãªã„ã‚ˆãªã¨ãŠã‚‚ã£ãŸã‘ã©ã€å®Ÿéš›ã¯ <code class="language-plaintext highlighter-rouge">Gemfile.lock</code> ã® <code class="language-plaintext highlighter-rouge">BUNDLED WITH</code> ãŒ <code class="language-plaintext highlighter-rouge">2.3.19</code> ã‚’æŒ‡å®šã—ã¦ã‚‹ã ã‘ã ã£ãŸã®ã§ã™ã€‚
ãªã®ã§å¯¾è±¡ã® 2 è¡Œã‚’å‰Šé™¤ã—ã¦ <code class="language-plaintext highlighter-rouge">bundle update</code> ã‚’å®Ÿè¡Œã—ã€ç¶šã„ã¦ <strong>rust</strong> ã‚µãƒãƒ¼ãƒˆã—ãŸ <strong>gem</strong> ã‚’ç”Ÿæˆã—ã¦ã€ <code class="language-plaintext highlighter-rouge">Cargo.toml</code> ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bundle gem <span class="nt">--mit</span> <span class="nt">--ext</span><span class="o">=</span>rust gem_name
Creating gem <span class="s1">'gem_name'</span>...
MIT License enabled <span class="k">in </span>config
Changelog enabled <span class="k">in </span>config
Initializing git repo <span class="k">in</span> /path/to/rust_uuid/gem_name
      create  gem_name/Gemfile
      create  gem_name/lib/gem_name.rb
      create  gem_name/lib/gem_name/version.rb
      create  gem_name/sig/gem_name.rbs
      create  gem_name/gem_name.gemspec
      create  gem_name/Rakefile
      create  gem_name/README.md
      create  gem_name/bin/console
      create  gem_name/bin/setup
      create  gem_name/.gitignore
      create  gem_name/.github/workflows/main.yml
      create  gem_name/LICENSE.txt
      create  gem_name/CHANGELOG.md
      create  gem_name/Cargo.toml
      create  gem_name/ext/gem_name/Cargo.toml
      create  gem_name/ext/gem_name/extconf.rb
      create  gem_name/ext/gem_name/src/lib.rs
Gem <span class="s1">'gem_name'</span> was successfully created. For more information on making a RubyGem visit https://bundler.io/guides/creating_gem.html
<span class="nv">$ </span><span class="nb">cat </span>Cargo.toml
<span class="c"># This Cargo.toml is here to let externals tools (IDEs, etc.) know that this is</span>
<span class="c"># a Rust project. Your extensions depedencies should be added to the Cargo.toml</span>
<span class="c"># in the ext/ directory.</span>

<span class="o">[</span>workspace]
members <span class="o">=</span> <span class="o">[</span><span class="s2">"./ext/gem_name"</span><span class="o">]</span>
resolver <span class="o">=</span> <span class="s2">"2"</span>
</code></pre></div></div>

<p>ã¨ã„ã†ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«ãŒå¾—ã‚‰ã‚Œã‚‹ã®ã§çœŸä¼¼ã—ã¦ä½œæˆã—ã¡ã‚ƒã„ã¾ã—ã‚‡ã†ã€‚</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[workspace]</span>
<span class="py">members</span> <span class="p">=</span> <span class="p">[</span><span class="s">"./ext/rust_uuid"</span><span class="p">]</span>
<span class="py">resolver</span> <span class="p">=</span> <span class="s">"2"</span>
</code></pre></div></div>

<p>ãã†ã—ãŸã‚‰ã‚‚ã†ä¸€åº¦ãƒ“ãƒ«ãƒ‰ã—ã¦ã—ã¾ã„ã¾ã™!</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>cargo generate-lockfile
<span class="nv">$ </span>git add Cargo.toml Carog.lock
<span class="nv">$ </span>bundle <span class="nb">exec </span>rake build
/usr/bin/gmake <span class="nb">install </span><span class="nv">target_prefix</span><span class="o">=</span>
generating target/release/librust_uuid.so <span class="o">(</span>release<span class="o">)</span>
cargo rustc <span class="nt">--target-dir</span> target <span class="nt">--manifest-path</span> ../../../../ext/rust_uuid/Cargo.toml <span class="nt">--lib</span> <span class="nt">--release</span> <span class="nt">--</span> <span class="nt">-C</span> <span class="nv">linker</span><span class="o">=</span>gcc <span class="nt">-L</span> <span class="nv">native</span><span class="o">=</span>/path/to/rbenv/versions/3.2.0/lib <span class="nt">-L</span> <span class="nv">native</span><span class="o">=</span>/path/to/rbenv/versions/3.2.0/lib <span class="nt">-L</span> <span class="nv">native</span><span class="o">=</span>/home/katsyoshi/.local/lib:-L/home/katsyoshi/.local/lib: <span class="nt">-C</span> link-arg<span class="o">=</span><span class="nt">-lm</span> <span class="nt">-l</span> pthread
   Compiling rust_uuid v0.1.0 <span class="o">(</span>/path/to/rust_uuid/ext/rust_uuid<span class="o">)</span>
    Finished release <span class="o">[</span>optimized] target<span class="o">(</span>s<span class="o">)</span> <span class="k">in </span>0.26s
installing rust_uuid.so to /path/to/rust_uuid/lib/rust_uuid
/usr/bin/install <span class="nt">-c</span> <span class="nt">-m</span> 0755 rust_uuid.so /path/to/rust_uuid/lib/rust_uuid
<span class="nb">cp </span>tmp/x86_64-linux/rust_uuid/3.2.0/rust_uuid.so tmp/x86_64-linux/stage/lib/rust_uuid/rust_uuid.so
rust_uuid 0.1.0 built to pkg/rust_uuid-0.1.0.gem.
<span class="nv">$ </span>bundle <span class="nb">exec </span>rake <span class="nb">install</span>
/usr/bin/gmake <span class="nb">install </span><span class="nv">target_prefix</span><span class="o">=</span>
generating target/release/librust_uuid.so <span class="o">(</span>release<span class="o">)</span>
cargo rustc <span class="nt">--target-dir</span> target <span class="nt">--manifest-path</span> ../../../../ext/rust_uuid/Cargo.toml <span class="nt">--lib</span> <span class="nt">--release</span> <span class="nt">--</span> <span class="nt">-C</span> <span class="nv">linker</span><span class="o">=</span>gcc <span class="nt">-L</span> <span class="nv">native</span><span class="o">=</span>/path/to/rbenv/versions/3.2.0/lib <span class="nt">-L</span> <span class="nv">native</span><span class="o">=</span>/path/to/rbenv/versions/3.2.0/lib <span class="nt">-L</span> <span class="nv">native</span><span class="o">=</span>/home/katsyoshi/.local/lib:-L/home/katsyoshi/.local/lib: <span class="nt">-C</span> link-arg<span class="o">=</span><span class="nt">-lm</span> <span class="nt">-l</span> pthread
    Finished release <span class="o">[</span>optimized] target<span class="o">(</span>s<span class="o">)</span> <span class="k">in </span>0.03s
installing rust_uuid.so to /path/to/rust_uuid/lib/rust_uuid
/usr/bin/install <span class="nt">-c</span> <span class="nt">-m</span> 0755 rust_uuid.so /path/to/rust_uuid/lib/rust_uuid
<span class="nb">cp </span>tmp/x86_64-linux/rust_uuid/3.2.0/rust_uuid.so tmp/x86_64-linux/stage/lib/rust_uuid/rust_uuid.so
<span class="nv">$ </span>bundle <span class="nb">exec </span>ruby <span class="nt">-rrust_uuid</span> <span class="nt">-e</span> <span class="s1">'puts RustUUID.v4'</span>
2eb053de-8ae7-4669-853b-95f06c872300
</code></pre></div></div>

<p>ã‚ˆã†ã‚„ã£ã¨é€šã£ãŸã‚ã‚ãã‚!!!!</p>

<h2 id="conclusion">conclusion</h2>

<p>å®Ÿéš›ã¯11æœˆã®æœ«ã‚ãŸã‚Šã« <strong>head</strong> ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ããªã„ãªã‚ã¨æ°—ãŒã¤ã„ã¦ã„ãŸã®ã§ã™ãŒã€ãã®ã†ã¡ç›´ã‚‹ã‚„ã‚ã¨æ€ã£ã¦ã¦ãªã«ã‚‚ã—ãªã‹ã£ãŸã®ã§ã™ã€‚ã„ã– <strong>Ruby 3.2</strong> ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸã¨ãã«è©¦ã—ã¦å‹•ã‹ãªã‹ã£ãŸã®ã§ã‚„ã£ã¨å¯¾å¿œã—ã¦ã¿ã¾ã—ãŸã€‚</p>

<p>ã¨ã„ã†ã“ã¨ã§æ­£å¼ã« <strong>Rust</strong> ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã§ã¾ãŸ YARUKI ãŒã§ã¦ãã¾ã™ã­ã€‚</p>

<p>ãã‚Œã¯ãã†ã¨ä»Šåº¦ã¯ã€<a href="https://jekyllrb.com"><strong>jekyll</strong></a> ãŒ <strong>Ruby 3.2</strong> ã§å‹•ã‹ãªããªã£ãŸã€‚</p>

  </div>

  <h1><a href="/blog/2022/10/15/goodbey-onamae-dot-com/">ãŠåå‰ãƒ‰ãƒƒãƒˆã‚³ãƒ ã®ãƒ¡ãƒ¼ãƒ«ãŒã†ã–ã™ããŸã®ã§ DNS ã‚’ Cloudflare ã«ç§»è¡Œã—ã¦å¿«é©ç”Ÿæ´»</a></h1>
  <p class="author">
    <span class="date">2022-10-15 23:59:50 +0900</span>
  </p>
  <div class="content">
    <p><strong>katsyoshi.org</strong> ã®ç™»éŒ²å…ˆã‚’ <a href="https://www.onamae.com"><strong>ãŠåå‰ãƒ‰ãƒƒãƒˆã‚³ãƒ </strong></a> ã«ã—ã¦ãŸã‘ã©ã€åºƒå‘Šã®ã‚ˆã†ãªãƒ¡ãƒ¼ãƒ«ã¨ã‹å±Šãã—
æ›´æ–°æ¡ˆå†…ã¨åºƒå‘Šã®é•ã„ãŒã‚ã‹ã‚‰ãªã„æ„Ÿã˜ã®ãƒ¡ãƒ¼ãƒ«ãŒå¤§é‡ã«ãã‚‹ã®ã§ã‚„ã‚ã‚ˆã†ã‚„ã‚ã‚ˆã†ã¨æ€ã£ã¦ãŸã®ã§ã„ã„ã‹ã’ã‚“å¤‰ãˆã¦ã¿ãŸè©±ã€‚</p>

<h2 id="æº–å‚™">æº–å‚™</h2>

<p>æº–å‚™ã¨ã—ã¦ç§»è¡Œå…ˆã®ãƒ¬ã‚¸ã‚¹ãƒˆãƒ©ã‚’é¸å®šã—ã¾ã™ã€‚
ç§»è¡Œå…ˆã¨ã—ã¦ã¯æ™®é€šã®ãƒ¬ã‚¸ã‚¹ãƒˆãƒ©ã¨ã‚¯ãƒ©ã‚¦ãƒ‰æ¥­è€…ãŒã‚„ã£ã¦ã„ã‚‹ãƒ¬ã‚¸ã‚¹ãƒˆãƒ©ãŒã‚ã‚‹ã¨æ€ã„ã¾ã™ãŒã€ä»Šå›ã¯ä»¥ä¸‹3ã¤ã‚’å€™è£œã«ã—ã¾ã—ãŸã€‚</p>

<ol>
  <li><a href="https://domains.google/intl/ja_jp/"><strong>Google Domains</strong></a>: <strong>Google</strong> ãŒã‚„ã£ã¦ã„ã‚‹ã‚„ã¤ã€‚ãƒ¡ãƒ¼ãƒ«ã¨ã‹ <strong>Google</strong> ãªã‚“ã§ <em>DNS</em> ã¾ã§ <strong>Google</strong> ã«ã™ã‚‹ã®ã¯å¿ƒç†çš„æŠµæŠ—ãŒå¼·ã„ã€‚</li>
  <li><a href="https://aws.amazon.com/jp/route53/"><strong>Route 53</strong></a>: ã¿ã‚“ãªã¤ã‹ã£ã¦ã‚‹ <strong>AWS</strong> ã®ã‚µãƒ¼ãƒ“ã‚¹ã€‚ä»•äº‹ã§åˆ©ç”¨ã—ã¦ã„ã‚‹ã®ã§ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã¯åˆ¥ã®ãŒã„ã„ã‹ãªã€‚</li>
  <li><a href="https://www.cloudflare.com/ja-jp/dns/"><strong>Cloudflare ã® DNS</strong></a>: ã¿ã‚“ãªã ã„ã™ãä½ä¾¡æ ¼ <em>CDN</em> æ¥­è€…ã® <a href="https://cloudflare.com"><strong>Cloudflare</strong></a> ãŒã‚„ã£ã¦ã‚‹ <em>DNS</em> ã‚µãƒ¼ãƒ“ã‚¹ã€‚</li>
</ol>

<p><strong>Google</strong> ã€ <strong>AWS</strong> ã¯è¨€ã‚ãšã¨çŸ¥ã‚ŒãŸå·¨å¤§ä¼æ¥­ã§ã‚µãƒ¼ãƒ“ã‚¹ãŒãªããªã‚‹ã¨ã„ã†ã“ã¨ã¯ãªã„ã¨ãŠã‚‚ã†ãŒã€
ä»•äº‹ã§åˆ©ç”¨ã—ãŸã‚Šã€æƒ…å ±å…¨éƒ¨é ã‘ãŸã‚Šã—ã¦ã„ã‚‹ã¨ã“ã‚ãªã®ã§é¸æŠã™ã‚‹ç†ç”±ãŒå€‹äººçš„ã«ã¯å¼±ã„ã€‚
å€‹äººåˆ©ç”¨ã§ã‚¬ãƒ³ã‚¬ãƒ³å¤‰ãˆãŸã‚Šã€ <strong>VPC</strong> ã§ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ§‹ç¯‰ã™ã‚‹ã‚ã‘ã˜ã‚ƒãªã„ã®ã§ <strong>Cloudflare</strong> ã§ã„ã„ã‹ãªã¨ã€‚</p>

<h3 id="ãŠåå‰ãƒ‰ãƒƒãƒˆã‚³ãƒ ã§ã®ä½œæ¥­">ãŠåå‰ãƒ‰ãƒƒãƒˆã‚³ãƒ ã§ã®ä½œæ¥­</h3>

<p>ãƒ¬ã‚¸ã‚¹ãƒˆãƒ©ã‚’ç§»ç®¡ã™ã‚‹å‰ã«ç¾åœ¨ç™»éŒ²ã—ã¦ã‚ã‚‹ <a href="https://www.nic.ad.jp/ja/whois/">WHOIS æƒ…å ±</a> ã‚’ç¢ºèªã—ã¾ã™ã€‚
ã“ã‚Œã¯ç§»ç®¡ä½œæ¥­ã§ç§»ç®¡ä½œæ¥­ç”¨ã‚³ãƒ¼ãƒ‰ãŒ WHOIS ç™»éŒ²è€…ã«ãƒ¡ãƒ¼ãƒ«ãŒé€ã‚‰ã‚Œã¦ãã‚‹ã®ã§ã©ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã®ç¢ºèªã§ã™ã€‚
ã“ã“ã§<a href="https://www.onamae.com/service/d-regist/option.html">WHOIS æƒ…å ±å…¬é–‹ä»£è¡Œ</a> ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯ã€
WHOIS ã‚’ä¸€æ—¦ç™»éŒ²æ™‚ã®ã‚‚ã®ã«å¤‰æ›´ã—ã¾ã™<sup id="fnref:org" role="doc-noteref"><a href="#fn:org" class="footnote" rel="footnote">1</a></sup>ã€‚</p>

<h2 id="ç§»ç®¡">ç§»ç®¡</h2>

<p>ç§»ç®¡ä½œæ¥­ã¨ã—ã¦ã¯æ–°è¦ãƒ¬ã‚¸ã‚¹ãƒˆãƒ©ã§<a href="https://developers.cloudflare.com/registrar/get-started/transfer-domain-to-cloudflare/">ç§»ç®¡ä¾é ¼</a>ã‚’å‚è€ƒã«ç§»ç®¡ä¾é ¼ãƒšãƒ¼ã‚¸ã‚’é–‹ãã¾ã™ã€‚
é–‹ã„ãŸã‚‰ã€æ—§ã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰ç§»ç®¡ã‚³ãƒ¼ãƒ‰ã®ç™ºè¡Œã‚’è¡Œãªã„ã¾ã™<sup id="fnref:onamae" role="doc-noteref"><a href="#fn:onamae" class="footnote" rel="footnote">2</a></sup>ã€‚
ç§»ç®¡ã‚³ãƒ¼ãƒ‰ã‚’ <a href="https://zenn.dev/a24k/articles/20220527-cloudflare-dns"><strong>Cloudflare</strong> å´ã§å…¥åŠ›ã—ã¦</a>ã—ã°ã—å¾…æ©Ÿã€‚</p>

<p>ã—ã°ã‚‰ãã—ãŸã‚‰ã€ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒç™»éŒ²ã•ã‚Œã‚‹ã®ã§å®Œäº†ã§ã™ã€‚</p>

<h2 id="ãŠã‚ã‚Š">ãŠã‚ã‚Š</h2>

<p>ã¨ã„ã†ã“ã¨ã§ <em>DNS</em> ã®ç™»éŒ²ã‚’ <strong>Cloudflare</strong> ã¸ç§»ç®¡ã—ã¾ã—ãŸã€‚
<strong>ãŠåå‰ãƒ‰ãƒƒãƒˆã‚³ãƒ </strong> ã¯ã‚ã®ãƒ¡ãƒ¼ãƒ«ã•ãˆãªã‘ã‚Œã°ç¶šã‘ãŸã®ã‹ã‚‚ã—ã‚Œãªã„ã€‚
ãŒæ›´æ–°è­¦å‘Šã¨æ™®é€šã®ãƒ¡ãƒ¼ãƒ«ã®é•ã„ãŒã‚ã¾ã‚Šã«ã‚‚ã‚ã‹ã‚‰ãªã„ã®ã§æ¨ã¦ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚
<strong>Cloudflare</strong> ã§ä¸æº€ãŒã‚ã£ãŸã‚‰ã¾ãŸå¤‰æ›´ã™ã‚‹ã¨æ€ã„ã¾ã™ãŒã€å¿«é©ãªç”Ÿæ´»ã«ãªã‚Šã¾ã—ãŸ(ãŸã¶ã‚“</p>

<hr />

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:org" role="doc-endnote">
      <p>å‰ã«ç§»è¡Œã—ã‚ˆã†ã¨ã—ãŸã¨ãã€<strong>.org</strong> ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯ WHOIS æƒ…å ±æ›¸ãå¤‰ãˆã‚‰ã‚Œãªãã¦ç§»è¡Œå¤±æ•—ã€‚ç¾åœ¨ã“ã®åˆ¶é™ã¯ãªããªã£ãŸã®ã§ç§»è¡Œã€‚Â <a href="#fnref:org" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:onamae" role="doc-endnote">
      <p>ã“ã„ã¤ãŒè¦‹ã¤ã‘ã«ããã€ãŠåå‰ãƒ‰ãƒƒãƒˆã‚³ãƒ ã‹ã‚‰ã¯è¦‹ã¤ã‘ã‚‰ã‚Œãšã«<a href="https://www.tsukimi.net/domain_onamae_xdomain.html">ç§»ç®¡ãƒ¬ãƒãƒ¼ãƒˆãƒ–ãƒ­ã‚°</a>ã‹ã‚‰ç™ºè¦‹ã€‚Â <a href="#fnref:onamae" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

  </div>

  <h1><a href="/blog/2022/10/12/ipv6nize-at-home/">Communicate on IPv6 from home</a></h1>
  <p class="author">
    <span class="date">2022-10-12 23:59:50 +0900</span>
  </p>
  <div class="content">
    <p>å®¶ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‹ã‚‰ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¸å‡ºã‚‹ã¨ã <code class="language-plaintext highlighter-rouge">IPoE</code> ã‚’ä½¿ã£ã¦ãŸã‘ã©ã€å®¶åº­å†… LAN ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯ <code class="language-plaintext highlighter-rouge">IPv6</code> ã‚’ off ã«ã—ã¦ã„ãŸã€‚
ã“ã® LAN å†… <code class="language-plaintext highlighter-rouge">IPv6</code> åŒ–ã—ã¦ã„ãªã‹ã£ãŸç†ç”±ã¨ã—ã¦ã¯ã€æ˜” Linux (ã ã‘ã˜ã‚ƒãªã„ã‹ã‚‚)ãŒ <code class="language-plaintext highlighter-rouge">IPv6</code> ãŒåˆ©ç”¨ã§ãã‚‹çŠ¶æ…‹ã ã¨
å…ˆã« <code class="language-plaintext highlighter-rouge">IPv6</code> ã§ç¹‹ãã«ã„ã“ã†ã¨ã—ã¦ <code class="language-plaintext highlighter-rouge">IPv6</code> ã§é€šä¿¡ã§ããªã‹ã£ãŸã‚‰ <code class="language-plaintext highlighter-rouge">IPv4</code> ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã™ã‚‹ã¨ã„ã†æŒ™å‹•ã§ã€ã™ã”ãã‚¹ãƒˆãƒ¬ã‚¹ãƒ•ãƒ«ã ã£ãŸã€‚
ã“ã®æŒ™å‹•ã®å¯¾å‡¦ã¨ã—ã¦ã€ã‚«ãƒ¼ãƒãƒ«ãƒ¬ãƒ™ãƒ«ã§ <code class="language-plaintext highlighter-rouge">IPv6</code> ã‚’ off ã«ã—ã¦ã¾ã—ãŸã€‚
ãã†ã“ã†ã—ã¦ã„ã‚‹ã†ã¡ã«å¥‘ç´„ã—ã¦ã„ã‚‹ ISP ãŒ <code class="language-plaintext highlighter-rouge">IPv6</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãªã—ã§ <code class="language-plaintext highlighter-rouge">IPoE</code> ã‚’åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã§ã€
ã¨ã‚Šã‚ãˆãš <code class="language-plaintext highlighter-rouge">IPoE</code> ã ã‘ã‚’åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã€å®¶åº­å†…ã® LAN ã¯ãã®ã¾ã¾ã¨ã„ã†çŠ¶æ…‹ã«ã—ã¦ã„ã¾ã—ãŸã€‚
ã„ã„ã‹ã’ã‚“ã“ã®å®¶åº­å†… LAN ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ <code class="language-plaintext highlighter-rouge">IPv6</code> åŒ–ã—ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¨ <code class="language-plaintext highlighter-rouge">IPv6</code> ã§é€šä¿¡ã§ãã‚‹ã‚ˆã†ã«ã—ãŸé¡›æœ«ã‚’ã®ã“ã™ã€‚ã®ã“ã—ã¾ã™ã€‚</p>

<h2 id="å®¶åº­å†…-lan-ç’°å¢ƒ">å®¶åº­å†… LAN ç’°å¢ƒ</h2>

<ul>
  <li>ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤: NEC IP38X/1210 (YAMAHA RTX1200)</li>
  <li>PC: 6.0.0-gentoo</li>
</ul>

<p><img src="/images/home2internet.png" alt="" /></p>

<h2 id="ipoe-åŒ–ã¨å®¶åº­å†…-lan-ã®-ipv6-åŒ–">IPoE åŒ–ã¨å®¶åº­å†… LAN ã® IPv6 åŒ–</h2>

<p>è¨­å®šã¯ <a href="https://network.yamaha.com/setting/router_firewall/flets/flets_other_service/ipv6_ipoe">YAMAHA ã®è¨­å®šä¾‹é›†</a>ã«è¼‰ã£ã¦ã‚ã‚‹ã®ã§ãã‚Œã‚’å‚è€ƒã«ã—ã¾ã™ã€‚
<code class="language-plaintext highlighter-rouge">IPoE</code> åŒ–ã¯ã“ã®è¨­å®šä¾‹ã§ã„ã‘ã‚‹ã®ã§ã™ãŒã€ã©ã†ã‚‚è¨­å®šã—ãŸã¨ãã«ãƒŸã‚¹ã£ãŸã‚‰ã—ãã€ LAN ã® IP ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒ <code class="language-plaintext highlighter-rouge">IPv4</code> ã§ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¸å‡ºã‚‹ã“ã¨ãŒã§ãã‚‹ãŒã€
<code class="language-plaintext highlighter-rouge">IPv6</code> ã§ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¸å‡ºã‚‹ã“ã¨ãŒã§ããªã„çŠ¶æ…‹ã«ãªã£ã¦ã—ã¾ã„ã¾ã—ãŸã€‚</p>

<h3 id="æ—§è¨­å®š">æ—§è¨­å®š</h3>
<p>ã©ã®ã‚ˆã†ãªè¨­å®šã ã£ãŸã‹ã¯ä»¥ä¸‹ã«</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ip route default gateway tunnel 1
ipv6 prefix 1 ra-prefix@lan2::/64
ipv6 lan1 address ra-prefix@lan2::1/64
ipv6 lan1 prefix ra-prefix@lan2::/64
ipv6 lan1 rtadv send 1
ipv6 lan1 dhcp service server
ipv6 lan2 address auto
ipv6 lan2 secure filter in 1010 1011 1012 2000
ipv6 lan2 secure filter out 3000 dynamic 100 101 102 103 104 105 106
ipv6 lan2 dhcp service client ir=on
ngn type lan2 ntt
tunnel select 1
 tunnel encapsulation ipip
 tunnel endpoint address 2404:8e00::feed:100
 tunnel enable 1
ipv6 filter 1010 pass * * icmp6 * *
ipv6 filter 1011 pass * * tcp * ident
ipv6 filter 1012 pass * * udp * 546
ipv6 filter 2000 reject * * * * *
ipv6 filter 3000 pass * * * * *
ipv6 filter dynamic 100 * * ftp
ipv6 filter dynamic 101 * * domain
ipv6 filter dynamic 102 * * www
ipv6 filter dynamic 103 * * smtp
ipv6 filter dynamic 104 * * pop3
ipv6 filter dynamic 105 * * tcp
ipv6 filter dynamic 106 * * udp
</code></pre></div></div>

<p>ã“ã®è¨­å®šã§ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¨ã¯ <code class="language-plaintext highlighter-rouge">IPv4</code> ã§ã—ã‹é€šä¿¡ã§ãã¦ã„ãªã„çŠ¶æ…‹ã§ã—ãŸã€‚
ã§ã“ã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒˆã¨ã—ã¦çŸ¥äºº(<a href="https://twitter.com/n_kane">@n_kane</a>, <a href="https://twitter.com/paina">@paina</a>) ã®ã¡ã‹ã‚‰ã‚’å€Ÿã‚Šã¦ã©ã“ã¾ã§é€šã˜ã¦ã©ã“ã‹ã‚‰é€šã˜ãªã„ã‹ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚</p>

<h3 id="troubleshooting">troubleshooting</h3>

<p>ã¨ã‚Šã‚ãˆãš <code class="language-plaintext highlighter-rouge">ping6</code> ã€ <code class="language-plaintext highlighter-rouge">traceroute6</code> ã§é€šã˜ã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ping6 -c 3 google.com

PING  google.com(nrt13s55-in-x0e.1e100.net (2404:6800:4004:824::200e)) 56 ãƒ‡ãƒ¼ã‚¿é•·(byte)

--- google.com ping çµ±è¨ˆ ---
é€ä¿¡ãƒ‘ã‚±ãƒƒãƒˆæ•° 3, å—ä¿¡ãƒ‘ã‚±ãƒƒãƒˆæ•° 0, ãƒ‘ã‚±ãƒƒãƒˆæå¤± 100%, æ™‚é–“ 2067ãƒŸãƒªç§’

$ traceroute6 google.com
traceroute to google.com, 30 hops max, 80 byte packets
 1  * * *
 2  * * *
 3  * * *
 4  * * *
 5  * * *
 6  * * *
 7  * * *
 8  * * *
 9  * * *
10  * * *
11  * * *
12  * * *
13  * * *
14  * * *
15  * * *
16  * * *
17  * * *
18  * * *
19  * * *
20  * * *
21  * * *
22  * * *
23  * * *
24  * * *
25  * * *
26  * * *
27  * * *
28  * * *
29  * * *
30  * * *
</code></pre></div></div>

<p>é€šã£ã¦ãªã„ã§ã™ã­ã€‚
å…ˆè¿°ã—ãŸã‚ˆã†ã« PC ã¯ <code class="language-plaintext highlighter-rouge">IPv6</code> ã‚’ on ã«ã—ãŸã°ã‹ã‚Šãªã®ã§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®è¨­å®šã§ãƒ–ãƒ­ãƒƒã‚¯ã—ã¦ã„ãªã„ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚
ã¾ãšã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§è€ƒãˆã‚‰ã‚Œã‚‹ã®ã¯ <code class="language-plaintext highlighter-rouge">iptables</code> ã§ã®ãƒ‘ã‚±ãƒƒãƒˆãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã§ã™ã­ã€‚
ãƒ«ãƒ¼ã‚¿ãƒ¼ã®ä¸‹ã«ã‚ã‚‹ PC ãªã®ã§ã€ã“ã“ã§ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹ã“ã¨ã¯ä½ã„ã®ã§ã™ãŒã€ç¢ºèªã—ã¾ã™ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># ip6tables --list
Chain INPUT (policy ACCEPT)
target     prot opt source               destination

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination
</code></pre></div></div>

<p>ãªã«ã‚‚ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã¦ã„ãªã„ã§ã™ã­ã€‚
ã¨ã„ã†ã“ã¨ã§ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã«ã¯å•é¡Œãªã•ãã†ã§ã™ã­ã€‚
ã©ã“ã¾ã§é€šã˜ã¦ã©ã“ã¾ã§é€šã˜ã¦ã„ãªã„ã®ã‹åˆ¥ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ç¢ºèªã—ã¾ã™ã€‚</p>

<p>ã¾ãšã€æ‰‹å…ƒã¨ç›¸æ‰‹ã§ <code class="language-plaintext highlighter-rouge">tcpdump</code> åˆ©ç”¨ã—ã¦ãƒ‘ã‚±ãƒƒãƒˆãŒé€ã£ã¦ã„ã‚‹ã‹å±Šã„ã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># tcpdump -nei enp8s0f0 icmp6
dropped privs to pcap
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on enp8s0f0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
22:35:41.158558 00:a0:de:69:40:9d &gt; 33:33:ff:51:5e:63, ethertype IPv6 (0x86dd), length 86: fe80::212:e2ff:fe70:6144 &gt; ff02::1:ff51:5e63: ICMP6, neighbor solicitation, who has 2409:10:a5c0:1f00:d903:ddb5:851:5e63, length 32
22:35:58.765783 ee:60:51:38:43:9c &gt; 33:33:ff:00:00:01, ethertype IPv6 (0x86dd), length 86: 2409:10:a5c0:1f00:5ce3:afcb:9bb2:5c1b &gt; ff02::1:ff00:1: ICMP6, neighbor solicitation, who has 2409:10:a5c0:1f00::1, length 32
22:36:09.249427 ee:60:51:38:43:9c &gt; 33:33:ff:00:00:01, ethertype IPv6 (0x86dd), length 86: 2409:10:a5c0:1f00:5ce3:afcb:9bb2:5c1b &gt; ff02::1:ff00:1: ICMP6, neighbor solicitation, who has 2409:10:a5c0:1f00::1, length 32
</code></pre></div></div>

<p>é€ã‚Œã¦ã¯ã„ã‚‹ã‚ˆã†ã§å¯¾å‘å´ã«ã‚‚å±Šã„ã¦ã„ãŸã‚‰ã—ãæˆ»ã‚Šã®ãƒ‘ã‚±ãƒƒãƒˆã¯é€ã£ã¦ãŸã‚ˆã†ã§ã™ãŒã€æ‰‹å…ƒã§ã¯æˆ»ã£ã¦ãã‚‹ãƒ‘ã‚±ãƒƒãƒˆã¯è¦‹ãˆã¦ã„ãªã„ã§ã™ã­ã€‚</p>

<p><img src="/images/ping6-failure.png" alt="" /></p>

<p>ã¨ã„ã†ã“ã¨ã¯ã‚„ã¯ã‚Šãƒ«ãƒ¼ã‚¿ãƒ¼ã®è¨­å®šãŒæ‚ªãã†ã¨ã„ã†ã“ã¨ãŒæ¨å¯Ÿã•ã‚Œã¾ã™ã­ã€‚
è¨­å®šã®ã©ã“ãŒæ‚ªã„ã®ã‹ã‚ã‚„ã—ã„ã¨ã“ã‚ã‚’è¦‹ã¦ã„ãã¾ã™ã€‚</p>

<p>æœ€åˆã«æ€ªã—ã„ã¨ãŠã‚‚ã£ãŸã®ã¯ãƒ«ãƒ¼ã‚¿ãƒ¼ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¾ã‚ã‚Šã§ã™ã€‚ä¸€æ—¦ã€<code class="language-plaintext highlighter-rouge">no ipv6 interface secure filer in</code> ã§å…¨éƒ¨ç„¡åŠ¹åŒ–ã—ã¾ã—ã‚‡ã†ã€‚ã—ã‹ã—ã¨ãã«å¤‰ã‚Šã¯ãªã„ã§ã™ã€‚ã“ã‚Œã¯ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãŒåŸå› ã§ã¯ãªã•ãã†ã§ã™ã­ã€‚</p>

<p>æ¬¡ã«ã‚ã‚„ã—ã„ç‚¹ã¯ä»¥ä¸‹2ã¤ã®è¨­å®š</p>

<ol>
  <li><a href="http://www.rtpro.yamaha.co.jp/RT/manual/rt-common/ipv6/ipv6_interface_address.html"><code class="language-plaintext highlighter-rouge">ipv6 interface address</code></a></li>
  <li><a href="http://www.rtpro.yamaha.co.jp/RT/manual/rt-common/ipv6/ipv6_interface_address.html"><code class="language-plaintext highlighter-rouge">ipv6 interface prefix</code></a></li>
</ol>

<p>ä¸Šã®ã‚³ãƒãƒ³ãƒ‰ã¯ ISP ã‹ã‚‰è‡ªå‹•ã§æŒ¯ã£ã¦ãã¦ã„ã‚‹ IP ã‚’å‰²ã‚Šå½“ã¦ã‚‹è¨­å®šã§ã€ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã¯ ISP ã‹ã‚‰æŒ¯ã£ã¦ããŸ <code class="language-plaintext highlighter-rouge">IPv6</code> ã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’ä»˜ã‘ã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®è¨­å®šã¨ãªã‚Šã¾ã™ã€‚
ã©ã†ã‚‚ã“ã®ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ãŒé‚ªé­”ãªã‚ˆã†ã§ã™ã€‚
<code class="language-plaintext highlighter-rouge">no ipv6 interface prefix</code> ã§ç„¡åŠ¹åŒ–ã§ãã‚‹ã®ã§ä¸€æ—¦å¤–ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
ã™ã‚‹ã¨</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ping6 -c 3 google.com
PING google.com(nrt20s18-in-x0e.1e100.net (2404:6800:4004:81c::200e)) 56 ãƒ‡ãƒ¼ã‚¿é•·(byte)
64 ãƒã‚¤ãƒˆå¿œç­” é€ä¿¡å…ƒ nrt20s18-in-x0e.1e100.net (2404:6800:4004:81c::200e): icmp_seq=1 ttl=57 æ™‚é–“=6.53ãƒŸãƒªç§’
64 ãƒã‚¤ãƒˆå¿œç­” é€ä¿¡å…ƒ nrt20s18-in-x0e.1e100.net (2404:6800:4004:81c::200e): icmp_seq=2 ttl=57 æ™‚é–“=2.73ãƒŸãƒªç§’
64 ãƒã‚¤ãƒˆå¿œç­” é€ä¿¡å…ƒ nrt20s18-in-x0e.1e100.net (2404:6800:4004:81c::200e): icmp_seq=3 ttl=57 æ™‚é–“=2.81ãƒŸãƒªç§’

--- google.com ping çµ±è¨ˆ ---
é€ä¿¡ãƒ‘ã‚±ãƒƒãƒˆæ•° 3, å—ä¿¡ãƒ‘ã‚±ãƒƒãƒˆæ•° 3, ãƒ‘ã‚±ãƒƒãƒˆæå¤± 0%, æ™‚é–“ 2002ãƒŸãƒªç§’
rtt æœ€å°/å¹³å‡/æœ€å¤§/mdev = 2.731/4.023/6.532/1.773ãƒŸãƒªç§’
</code></pre></div></div>

<p>ã®ã‚ˆã†ã«é€šã‚Šã¾ã—ãŸ!å‹ã£ãŸãƒƒ!ç¬¬ä¸‰éƒ¨å®Œ!</p>

<h2 id="ãŠã‚ã‚Š">ãŠã‚ã‚Š</h2>

<p>ä»¥å‰ä¸­é€”åŠç«¯ã«è¨­å®šã—ãŸãŠã‹ã’ã§ <code class="language-plaintext highlighter-rouge">IPv6</code> æœ‰åŠ¹åŒ–ã«æ™‚é–“ãŒæ›ã£ã¦ã—ã¾ã£ãŸé¡›æœ«ã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚
ã“ã‚Œã§å®¶ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‹ã‚‰ <code class="language-plaintext highlighter-rouge">IPv6</code> ã§é€šä¿¡ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ!</p>

<p>æ¬¡å› katsyoshi.org ãŠåå‰.COM ã‚„ã‚ã‚‹ã£ã¦ã‚ˆ</p>

  </div>

  <h1><a href="/blog/2022/09/11/had-lovely-days-at-rubykaigi-2022/">RubyKaigi æœ€é«˜ï¼</a></h1>
  <p class="author">
    <span class="date">2022-09-11 23:59:50 +0900</span>
  </p>
  <div class="content">
    <p><a href="https://rubykaigi.org/2022">RubyKaigi 2022</a> ã«è¡Œã£ã¦ãã¾ã—ãŸ! ã®ã§æ„Ÿæƒ³ã‚’</p>

<h2 id="day-0">DAY 0</h2>

<p>ä»Šå›ã‚‚ <a href="https://yancya.house/">ã‚„ã‚“ã¡ã‚ƒãƒã‚¦ã‚¹</a> ã«æ¥½ã‚’ã—ã¦æ³Šã¾ã‚‹ã“ã¨ã«ã—ã¦ãŸã®ã§ãªã«ã‚‚æ°—ã«ã›ãšå®¿ã¸ã€‚
ç€ã„ã¦ä»–ãƒ¡ãƒ³ãƒãƒ¼ãŒæ¥ã‚‹ã¾ã§å®¿ã§å¾…æ©Ÿã—ã¦ãŸãŒã€æœ€å¯„ã‚Šé§…ã®å‘¨ã‚ŠãŒæ€ã£ãŸä»¥ä¸Šã«ãªã«ã‚‚ãªãã€é€”æ–¹ã«æš®ã‚Œã¦ã¾ã—ãŸã€‚</p>

<h4 id="å¤•é£¯">å¤•é£¯</h4>

<p>ã‚‚ã†ã²ã¨ã‚Šå®¿ã«ç€ã„ãŸã®ã§å…¥ã‚Œå¤‰ã‚ã‚Šã§å¤•é£¯ã¸å‡ºã‹ã‘ãŸãŒã€ãã‚‚ãã‚‚æœ€å¯„ã‚Šé§…å‰ã«ã¯ãªã«ã‚‚ãªã„ã®ã§ä¼Šå‹¢é§…ã¾ã§å‡ºã‚‹ã“ã¨ã«ã—ãŸã€‚</p>

<p>ã“ã®åˆ¤æ–­ãŒé–“é•ãˆã¦ãŸã‚ˆã†ã§ã€ä¼Šå‹¢é§…ã«å‡ºã¦ã‚‚ã¨ãã«å¤‰ã‚‰ãªã‹ã£ãŸã€‚ã—ã‹ã—å¹¸ã„ä¼Šå‹¢é§…å‰ã«æ‹…ã€…éººå±‹ãŒã‚ã£ãŸã®ã§ãã“ã§é£Ÿæ–™æ‘‚å–ã—ãŸã€‚</p>

<h2 id="day-1">DAY 1</h2>

<p>ã“ã®æ—¥ã®èã„ãŸã‚»ãƒˆãƒªã¨æ„Ÿæƒ³ã¯ä»¥ä¸‹ã®ã¨ãŠã‚Š</p>

<h4 id="ruby-meets-webassembly-presentation"><a href="https://rubykaigi.org/2022/presentations/kateinoigakukun.html">Ruby meets WebAssembly</a>: <a href="">presentation</a></h4>

<p>ã“ã®æ—¥ã®ã‚­ãƒ¼ãƒãƒ¼ãƒˆã¯ <a href="https://www.ruby-lang.org/"><code class="language-plaintext highlighter-rouge">Ruby</code></a> ã® <a href="https://webassembly.org/"><code class="language-plaintext highlighter-rouge">wasm</code></a> å¯¾å¿œã®è©±ã§ <a href="https://wasi.dev/"><code class="language-plaintext highlighter-rouge">wasi</code></a> ã‚’é€šã˜ã¦ãƒ–ãƒ©ã‚¦ã‚¶ã§ <code class="language-plaintext highlighter-rouge">Ruby</code> ãŒå‹•ã‹ã™ã¾ã§ã®ãŸã®ã—ã„ã“ã¨ã‚’ã—ã‚ƒã¹ã£ã¦ãŸã‚ˆã†ã§ã™ã€‚
ãŠãªã‹ã„ãŸãã¦ãƒˆã‚¤ãƒ¬è¡Œã£ã¦ãŸã‚‰é¢ç™½ã„ã¨ã“ã‚èãé€ƒãŒã—ã¦ã—ã¾ã£ãŸã€‚</p>

<h4 id="ãƒ©ãƒ³ãƒ">ãƒ©ãƒ³ãƒ</h4>
<p>é©å½“ã«å¹•ã®å†…å¼å½“ã‚’æœ€åˆã«é¸æŠã€‚</p>

<h4 id="making-many-threads-on-ruby-presentation"><a href="https://rubykaigi.org/2022/presentations/ko1.html">Making *MaNy* threads on Ruby</a>: <a href="">presentation</a></h4>

<p>ç¬¹ç”°ã•ã‚“ã®ç™ºè¡¨ã§å¦‚ä½•ã« <code class="language-plaintext highlighter-rouge">Ruby</code> ã§ CPU ã‚’ãƒ•ãƒ«ã«ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã‹ã®è©±ã€‚ <code class="language-plaintext highlighter-rouge">Ruby</code> ã§ã® <code class="language-plaintext highlighter-rouge">Thread</code> ã®ã¯ãªã—ã‹ã‚‰ <a href="https://github.com/ruby/ruby/blob/master/doc/ractor.md"><code class="language-plaintext highlighter-rouge">Ractor</code></a> ã‚’åˆ©ç”¨ã—ã¦ãƒ•ãƒ«ãƒ•ãƒ«ã« CPU åˆ©ç”¨ã™ã‚‹ãŸã‚ã®æ›¸ãã‹ãŸã¨ã‹ã®è©±ã—ã¦ã„ã¾ã—ãŸã€‚</p>

<h4 id="building-a-lightweight-ir-and-backend-for-yjit-presentation"><a href="https://rubykaigi.org/2022/presentations/maximecb.html">Building a Lightweight IR and Backend for YJIT</a>: <a href="">presentation</a></h4>

<p><code class="language-plaintext highlighter-rouge">Ruby 3.1</code> ã§ <a href="https://github.com/Shopify/yjit"><code class="language-plaintext highlighter-rouge">YJIT</code></a> ãŒå…¥ã£ã¦ <code class="language-plaintext highlighter-rouge">Ruby 3.2</code> ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ CPU ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãŒå¢—ãˆãŸã¯ãªã—ã€‚RubyVM(ï¼Ÿ) ã« <code class="language-plaintext highlighter-rouge">YJIT</code> ç”¨ <code class="language-plaintext highlighter-rouge">Ruby IR</code> ã‚’ä½œæˆã—ã¦ <code class="language-plaintext highlighter-rouge">JIT</code> ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã„ã†è©±ã€‚
èã„ã¦ã¦ç–‘å•ã«ãªã£ãŸç‚¹ã¨ã—ã¦ã¯ã€ <code class="language-plaintext highlighter-rouge">Ruby IR</code> ã§ã¯ç›´æ¥æ©Ÿæ¢°èªã«ç¿»è¨³ã—ã¦ã„ã‚‹ã‚ˆã†ã ã£ãŸãŒã€ã“ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã« <a href="https://llvm.org"><code class="language-plaintext highlighter-rouge">LLVM</code></a> ã‚’åˆ©ç”¨ã—ã¦ã„ãªã„ã®ã¯ãªã‚“ã§ãªã‚“ã ã‚ã†ã€‚èãé€ƒãŒã—ã¦ã„ã‚‹ã¨ã„ã†è©±ã¯ã‚ã‚‹ã®ã§ã€è©³ã—ã„ã²ã¨æ•™ãˆã¦ã€‚</p>

<h4 id="tools-for-providing-rich-user-experience-in-debugger-presentation"><a href="https://rubykaigi.org/2022/presentations/ono-max.html">Tools for Providing rich user experience in debugger</a>: <a href="">presentation</a></h4>

<p><a href="https://github.com/ruby/debug"><code class="language-plaintext highlighter-rouge">debug.gem</code></a> ã‚’ <a href="https://code.visualstudio.com/"><code class="language-plaintext highlighter-rouge">VS Code</code></a> ã ã‘ã˜ã‚ƒãªãã€ <a href="https://www.google.com/intl/ja_jp/chrome/"><code class="language-plaintext highlighter-rouge">Chrome</code></a> ã®ãƒªãƒ¢ãƒ¼ãƒˆãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½ã‚’åˆ©ç”¨ã—ãŸãƒ‡ãƒãƒƒã‚°ã®è©±ã§ã—ãŸã€‚
ã“ã®æ©Ÿèƒ½è‡ªä½“ã¯ã™ã”ãä¾¿åˆ©ã ã¨æ€ã†ã®ã§ã™ãŒã€ãã‚‚ãã‚‚ä¸¡æ–¹ã¨ã‚‚å®—æ•™ä¸Šã®ç†ç”±ã§åˆ©ç”¨ã§ããªã„ä½“ãªã®ã§èãã ã‘ã§ã—ãŸã€‚</p>

<h4 id="trick-2022-returns-repos"><a href="https://rubykaigi.org/2022/presentations/tric.html">TRICK 2022 (Returns)</a>: <a href="">repos</a></h4>

<p>ã„ã¤ã‚‚é€šã‚Š <del>å¤‰ãª</del> ã‚¨ã‚­ã‚»ãƒ³ãƒˆãƒªãƒƒã‚¯ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã—ã‹å‡ºã¦ã“ãªã‹ã£ãŸã—ã€ã„ã¤ã‚‚ã®é¢å­ãŒè³ã‚‚ã‚‰ã£ã¦ãŸã®ã§ã™ã”ã„ãªãƒ¼ã¨ã„ã†æ„Ÿæƒ³ã€‚</p>

<h4 id="å¤•é£¯-1">å¤•é£¯</h4>

<p>ã“ã®æ—¥ã¯æ´¥é§…ãŒã‚ã¾ã‚Šãªã•ãã†ã ã£ãŸã®ã§ã€é§…è¿‘ãã§é£²ã‚€ã®ã§ã¯ãªãã€å®¿å¯„ã‚Šã®å ´æ‰€æ¾å‚é§…ã§é£²ã‚€ã“ã¨ã«ã—ãŸã€‚
ã“ã“ã§ã€æ´¥ã®å¤œæƒ…å ±ã‚’èãè¾¼ã‚“ã ã‚Šã€æœã”ã¯ã‚“æƒ…å ±è‡ªä½“ã‚’ä»•å…¥ã‚Œã¦ã¾ã—ãŸã€‚</p>

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">æ˜¨æ—¥ã®å¤•é£¯ <a href="https://twitter.com/hashtag/rubykaigi?src=hash&amp;ref_src=twsrc%5Etfw">#rubykaigi</a> <a href="https://t.co/G8lmetYX9J">pic.twitter.com/G8lmetYX9J</a></p>&mdash; katsyoshi (@katsyoshi) <a href="https://twitter.com/katsyoshi/status/1568012256566480896?ref_src=twsrc%5Etfw">September 8, 2022</a></blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<h2 id="day-2">DAY 2</h2>
<p>2æ—¥ç›®ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒä¸å®‰å®šã«ãªã£ãŸã‚Šã—ã¦ã“ã¡ã‚‰ã®é›†ä¸­åŠ›ãŒåˆ‡ã‚ŒãŸã‚Šã—ãŸã®ã§ã‚ã¾ã‚Šè¦šãˆã¦ã„ãªã„ã€‚</p>

<h4 id="æœã”ã¯ã‚“">æœã”ã¯ã‚“</h4>

<p>å‰æ—¥ã®å¤•é£¯ã«æ•™ãˆã¦ã‚‚ã‚‰ã£ãŸå¸‚å ´ã®äººå‘ã‘é£Ÿå ‚ãŒæ¾å‚é§…å‰ã«ã‚ã‚Šã€ãã®é£Ÿå ‚ã§é£Ÿäº‹ã‚’ã—ãŸã€‚</p>

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">æœãƒ¡ãƒƒã‚· <a href="https://twitter.com/hashtag/rubykaigi?src=hash&amp;ref_src=twsrc%5Etfw">#rubykaigi</a> <a href="https://t.co/PvbaUrRUIf">pic.twitter.com/PvbaUrRUIf</a></p>&mdash; katsyoshi (@katsyoshi) <a href="https://twitter.com/katsyoshi/status/1568019085430259712?ref_src=twsrc%5Etfw">September 8, 2022</a></blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<h4 id="matz-keynote-presentation"><a href="https://rubykaigi.org/2022/presentations/yukihiro_matz.html">Matz Keynote</a>: <a href="">presentation</a></h4>

<h4 id="do-pure-ruby-dream-of-encrypted-binary-protocol-presentation"><a href="https://rubykaigi.org/2022/presentations/yu_suke1994.html">Do Pure Ruby Dream of Encrypted Binary Protocol?</a>: <a href="">presentation</a></h4>

<p>ãƒãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆã€‚</p>

<h4 id="ãƒ©ãƒ³ãƒ-1">ãƒ©ãƒ³ãƒ</h4>

<p>ã“ã®æ—¥ã‚‚ä¸€ç•ªã«å¼å½“ã‚’å–å¾—ã€‚å¼å½“ã¯ã¿ã‚“ãªå¤§å¥½ãæ¾å‚ç‰›ãƒ­ãƒ¼ã‚¹ãƒˆãƒ“ãƒ¼ãƒ•ä¸¼ã«ã—ãŸã€‚æ„Ÿæƒ³ã¨ã—ã¦ã¯ã€ã‚‚ã†è‚‰ã¯ã„ã„ã‹ãªã€‚</p>

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">æ˜¼é£¯ã€€<a href="https://twitter.com/hashtag/rubykaigi?src=hash&amp;ref_src=twsrc%5Etfw">#rubykaigi</a> <a href="https://t.co/vpOf6Uwf0K">pic.twitter.com/vpOf6Uwf0K</a></p>&mdash; katsyoshi (@katsyoshi) <a href="https://twitter.com/katsyoshi/status/1568070622210826240?ref_src=twsrc%5Etfw">September 9, 2022</a></blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<h4 id="è‡ªã‚­kaigi">è‡ªã‚­Kaigi</h4>

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">ãã‚‡ã†ã‚‚ <a href="https://twitter.com/hashtag/%E8%87%AA%E3%82%ADKaigi?src=hash&amp;ref_src=twsrc%5Etfw">#è‡ªã‚­Kaigi</a> ã‚„ã‚Šã¾ã™ã€‚ãƒ©ãƒ³ãƒé£Ÿã¹ãŸã‚‰ã‚¹ãƒãƒ³ã‚µãƒ¼ã‚¨ãƒªã‚¢ã®æ‰‹å‰ã‚ãŸã‚Šã«ãŠé›†ã¾ã‚Šãã ã•ã„ <a href="https://twitter.com/hashtag/rubykaigi?src=hash&amp;ref_src=twsrc%5Etfw">#rubykaigi</a></p>&mdash; ğŸ‡ºğŸ‡¦hasumikinğŸ‡ºğŸ‡¦ (@hasumikin) <a href="https://twitter.com/hasumikin/status/1568023525407211521?ref_src=twsrc%5Etfw">September 8, 2022</a></blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>èª˜ã‚ã‚ŒãŸã®ã§å‚åŠ ã—ã¾ã—ãŸã€‚iPad ã§æ´»å‹•ã—ã‚ˆã†ã¨æ€ã„ <a href="https://github.com/foostan/crkbd">corne</a> æŒã£ã¦ã„ã£ã¦ãŸã®ã§å‚åŠ ã—ã¦ãŸã€‚</p>

<h4 id="ruby-x-bpf-in-action-how-important-observability-is-presentation"><a href="https://rubykaigi.org/2022/presentations/udzura.html">Ruby x BPF in Action: How important observability is</a>: <a href="">presentation</a></h4>
<h4 id="hunting-production-memory-leaks-with-heap-sampling-presentation"><a href="https://rubykaigi.org/2022/presentations/KnuX.html">Hunting Production Memory Leaks with Heap Sampling</a>: <a href="">presentation</a></h4>
<p>ã“ã®ã‚ãŸã‚Šãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒä¸å®‰å®šã«ãªã‚Šã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒä¸­æ–­ã•ã‚ŒãŸã‚Šã—ãŸãŸã‚ã‚ã¾ã‚Šè¦šãˆã¦ã„ãªã„ã€‚</p>

<h4 id="ç«‹ã¡è©±">ç«‹ã¡è©±</h4>

<p>ä¹…ã—æŒ¯ã‚Šã®å¯¾é¢ã§ã®å‚åŠ ã ã£ãŸã®ã§ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚ã¾ã‚Šèã‹ãšã«å—ã‘ä»˜ã‘å‰ã§ç«‹ã¡è©±ã—ã¦ã„ã‚‹äººãŸã¡ãŒã„ãŸã®ã§ã€ãã®ç«‹ã¡è©±ã«å‚åŠ ã—ãŸã€‚
ãŸã¾ãŸã¾ã€æœ€è¿‘èª­ã‚“ã§ã‚‹æœ¬ã®ç¿»è¨³è€…ãŒã„ãŸã®ã§ã“ã‚Œã‹ã‚‰ã®è©±ãªã©ã‚’èã„ãŸã‚Šã—ã¦ã„ãŸã€‚</p>

<h4 id="caching-with-messagepack-presentation"><a href="https://rubykaigi.org/2022/presentations/shioyama.html">Caching With MessagePack</a>: <a href="">presentation</a></h4>
<h4 id="ruby-committers-vs-the-world"><a href="https://rubykaigi.org/2022/presentations/rubylangorg.html">Ruby Committers vs The World</a></h4>

<h4 id="å¤•é£¯-2">å¤•é£¯</h4>

<p>å¤•é£¯ã¯ã€é§…è¿‘ãã®ãŠåº—ã§ã‹ã‚‹ã3äººã§ã€‚</p>

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">ã„ã¾ã©ã“</p>&mdash; tagomoris (@tagomoris) <a href="https://twitter.com/tagomoris/status/1568221035702685696?ref_src=twsrc%5Etfw">September 9, 2022</a></blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>ã“ã‚“ãªãƒªãƒ—ãƒ©ã‚¤ãŒãã¦ãŸã‚ˆã†ãªã®ã§ä¸€ç·’ã«ã„ãŸã²ã¨ã«ã¾ã‹ã›ãŸã€‚ã‚®ãƒªã‚®ãƒªã¾ã§ç²˜ã£ã¦ãŸã®ã§å¸°å®¿å¾Œã™ãå°±å¯ã€‚</p>

<h2 id="day-3">DAY 3</h2>

<p>3æ—¥ç›®ã¯ãã‚‚ãã‚‚å‰2æ—¥ã®ç–²ã‚ŒãŒå‡ºãŸã‚Šã—ãŸã®ã‹ã»ã¨ã‚“ã©è¦šãˆã¦ã„ãªã„ã€‚ã‚ã¨ <a href="https://ruby-puzzles-2022.cookpad.tech/">ruby puzzle</a> ã‚’ã‚„ã£ã¦ã„ã¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ã‚ã¾ã‚Šèã‘ã¦ã„ãªã„ã€‚</p>

<h4 id="æœã”ã¯ã‚“-1">æœã”ã¯ã‚“</h4>

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">ä»Šæ—¥ã‚‚ä¸€æ—¥ <a href="https://twitter.com/hashtag/rubykaigi?src=hash&amp;ref_src=twsrc%5Etfw">#rubykaigi</a> <a href="https://t.co/PKnj8sHxwE">pic.twitter.com/PKnj8sHxwE</a></p>&mdash; katsyoshi (@katsyoshi) <a href="https://twitter.com/katsyoshi/status/1568387387088322560?ref_src=twsrc%5Etfw">September 9, 2022</a></blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<h4 id="megaruby---running-mrubyc-programs-on-sega-mega-drive-presentation"><a href="https://rubykaigi.org/2022/presentations/yujiyokoo.html">Megaruby - Running mruby/c programs on Sega Mega Drive</a>: <a href="">presentation</a></h4>

<p>ã“ã‚Œã«é–“ã«åˆã†ã‚ˆã†ã«å‡ºãŸã¯ãšã ã£ãŸãŒã€é–“ã«åˆã‚ãšèã„ã¦ã„ãŸã€‚ãƒ¡ã‚¬ãƒ‰ãƒ©ã‚¤ãƒ–ã™ã’ãˆã€‚</p>

<h4 id="automatically-find-memory-leaks-in-native-gems-presentation"><a href="https://rubykaigi.org/2022/presentations/peterzhu2118.html">Automatically Find Memory Leaks in Native Gems</a>: <a href="">presentation</a></h4>
<h4 id="fast-data-processing-with-ruby-and-apache-arrow-presentation"><a href="https://rubykaigi.org/2022/presentations/ktou.html">Fast data processing with Ruby and Apache Arrow</a>: <a href="">presentation</a></h4>
<h4 id="fixing-assignment-evaluation-order-presentation"><a href="https://rubykaigi.org/2022/presentations/jeremyevans0.html">Fixing Assignment Evaluation Order</a>: <a href="">presentation</a></h4>
<h4 id="stories-from-developing-yjit-presentation"><a href="https://rubykaigi.org/2022/presentations/alanwusx.html">Stories from developing YJIT</a>: <a href="">presentation</a></h4>

<h2 id="ã¾ã¨ã‚">ã¾ã¨ã‚</h2>

<p>3å¹´ã¶ã‚Šã®ç¾åœ°é–‹å‚¬ã ã£ãŸã®ã§å‚åŠ ã—ã¦ãã¾ã—ãŸã€‚å¯¾é¢ã§ã®å‚åŠ ã¯ã‚„ã¯ã‚Šã‚ˆã„ã‚‚ã®ã§æ–°ã—ã„å‡ºä¼šã„ã‚„ã€ç–‘å•ã‚’æœ¬äººã€è§£ã£ã¦ã„ã‚‹äººã«ç›´æ¥èãã“ã¨ãŒã§ãã¦ã™ã°ã‚‰ã—ã„ä½“é¨“ã§ã—ãŸã€‚</p>

<h3 id="ä¸‰é‡ã«ã¤ã„ã¦">ä¸‰é‡ã«ã¤ã„ã¦</h3>
<p>ä¸‰é‡çœŒã®é…’ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ã€è¡Œãå‰ã¯ã€Œä½œã€ã€Œ è€Œä»Šã€ã€Œä¼Šå‹¢è§’è°·å±‹éº¦é…’ã€ã¨ã„ã†ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã—ãŸã€‚
ã¨ãã«æ—¥æœ¬é…’ã¯ç¾å‘³ã—ã„ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒã‚ã‚Šã€çŸ¥ã‚‰ãªã„æ—¥æœ¬é…’ã‚‚ã‚ã£ãŸã‚Šã™ã‚‹ã‚“ã ã‚ã†ãªã‚ã¨æ€ã£ã¦ã„ã¾ã—ãŸã€‚
è¡Œã£ã¦ã¿ã‚‹ã¨æ—¥æœ¬é…’ã¯ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨å¤‰ã‚ã‚‰ãªã„ã®ã§ã™ãŒã€ã ã„ãŸã„ä¼¼ãŸå‘³ã®å‚¾å‘ã§é£½ãã‚‹ã¨ã„ã†ã‹ãªã‚“ã¨ã„ã†ã‹
ç¾å‘³ã—ã„ã‚“ã ã‘ã©ã€å¥½ãã˜ã‚ƒãªã„ã¨ã„ã†æ„Ÿæƒ³ã«ãªã£ã¦ã—ã¾ã£ãŸã€‚
ãƒ“ãƒ¼ãƒ«ã«ã¤ã„ã¦ã¯ç“¶ãƒ“ãƒ¼ãƒ«ã—ã‹é£²ã¾ãªã‹ã£ãŸã®ã§æ„Ÿæƒ³ã¯ãªã—ã§ã€‚</p>

<p>ä¸‰é‡ã¯å¤§ããªè¡—ãŒæ¯”è¼ƒçš„åˆ†æ•£ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã€æ´¥ã‚‚æ¾å‚ã‚‚ä¼Šå‹¢ã‚‚é³¥ç¾½ã‚‚é§…å‰ãŒå°ã•ãæ„Ÿã˜ã¾ã—ãŸã€‚
ã¨ãã«0æ—¥ç›®ã®é£Ÿäº‹ãŒå¤§å¤‰ã§ã€èª¿é”ãŒé›£ã—ã‹ã£ãŸã€‚</p>

  </div>

  <h1><a href="/blog/2022/08/12/how-to-use-rust-in-ruby-gems/">Ruby gem ã§ Rust ã‚’ã¤ã‹ã£ã¦çˆ†é€Ÿã«ã—ãŸã„!!!!!!11</a></h1>
  <p class="author">
    <span class="date">2022-08-12 13:59:59 +0900</span>
  </p>
  <div class="content">
    <p><a href="https://rubygems.org">Ruby Gems</a> ã§ <a href="https://www.rust-lang.org">Rust</a> ãŒ <a href="https://github.com/rubygems/rubygems/pull/5175">Native ã¨ã—ã¦åˆ©ç”¨å¯èƒ½ã«ãªã£ãŸ</a> ã®ã§ã¨ã‚Šã‚ãˆãš <a href="https://www.rfc-editor.org/rfc/rfc4122.html"><code class="language-plaintext highlighter-rouge">UUIDv4</code></a> ã‚’ç”Ÿæˆã—ã¦ã¿ãŸã€‚</p>

<h3 id="ãƒªãƒã‚¸ãƒˆãƒª">ãƒªãƒã‚¸ãƒˆãƒª</h3>
<p><a href="https://github.com/katsyoshi/rust_uuid"><img src="https://gh-card.dev/repos/katsyoshi/rust_uuid.svg" alt="katsyoshi/rust_uuid - GitHub" /></a></p>

<h2 id="æº–å‚™">æº–å‚™</h2>

<p>Ruby å´ã® <code class="language-plaintext highlighter-rouge">gem</code> ã« Rust ã‚’åˆ©ç”¨ã™ã‚‹æº–å‚™ã¨ã—ã¦ <a href="https://github.com/oxidize-rb/rb-sys"><code class="language-plaintext highlighter-rouge">rb_sys</code></a> ã¨ <a href="https://github.com/rake-compiler/rake-compiler"><code class="language-plaintext highlighter-rouge">rake-compiler</code></a> ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚ã“ã®äºŒã¤ã® <code class="language-plaintext highlighter-rouge">gem</code> ã¯ native compile ã™ã‚‹ãŸã‚ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãŠãã¾ã™ã€‚
Rust å´ã‹ã‚‰ Ruby ã¸é–¢æ•°ã‚’å…¬é–‹ã™ã‚‹ãŸã‚ã« <a href="https://github.com/oxidize-rb/rb-sys"><code class="language-plaintext highlighter-rouge">rb-sys</code></a> ã¨ <a href="https://github.com/matsadler/magnus"><code class="language-plaintext highlighter-rouge">magnus</code></a> ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚</p>

<h2 id="gem-install">gem install</h2>

<p>ã¨ã‚Šã‚ãˆãš <code class="language-plaintext highlighter-rouge">cargo</code> ã§ Rust ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½œã£ã¦ Rust ã‚’æ›¸ã„ã¦ã¿ã¾ã™ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> bundle gem rust_uuid <span class="nt">--mit</span> <span class="nt">--ext</span> rust_uuid <span class="c"># --ext ã‚’æŒ‡å®šã—ã¦native build ã™ã‚‹ gem ã‚’ä½œæˆ</span>
<span class="o">&gt;</span> <span class="nb">cd </span>rust_uuid <span class="c"># ä½œæˆã—ãŸ gem ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸ç§»å‹•</span>
<span class="o">&gt;</span> <span class="nb">cd </span>ext/rust_uuid <span class="c"># ãƒ“ãƒ«ãƒ‰ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸ç§»å‹•</span>
<span class="o">&gt;</span> cargo init <span class="nb">.</span> <span class="nt">--lib</span> <span class="c"># cargo ã‚’åˆæœŸåŒ–</span>
<span class="o">&gt;</span> <span class="nb">rm</span> <span class="nt">-f</span> <span class="k">*</span>.c <span class="k">*</span>.h <span class="c"># C ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã‚‹ã®ã§å‰Šé™¤</span>
<span class="o">&gt;</span> cargo add rb-sys rb-allocator
<span class="o">&gt;</span> cargo add magnus <span class="nt">--features</span> rb-sys-interop
<span class="o">&gt;</span> cargo add uuid <span class="nt">--features</span> v4 <span class="c"># uuid v4 ã‚’æŒ‡å®š</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">ext/rust_uuid/extconf.rb</code> ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ç·¨é›†ã—ã¾ã™ã€‚</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@@ -1,5 +1,6 @@</span>
 # frozen_string_literal: true
 
 require "mkmf"
<span class="gi">+require "rb_sys/mkmf"
</span> 
<span class="gd">-create_makefile("rust_uuid/rust_uuid")
</span><span class="gi">+create_rust_makefile("rust_uuid/rust_uuid")
</span></code></pre></div></div>

<p>æ¬¡ã« <code class="language-plaintext highlighter-rouge">ext/rust_uuid/src/lib.rs</code> ã‚’ä»¥ä¸‹ã®æ§˜ã«å¤‰æ›´ã—ã¾ã™ã€‚</p>

<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">use</span> <span class="nn">magnus</span><span class="p">::{</span><span class="n">define_module</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="nn">prelude</span><span class="p">::</span><span class="o">*</span><span class="p">,</span> <span class="n">Error</span><span class="p">};</span>
<span class="k">use</span> <span class="nn">rb_allocator</span><span class="p">::</span><span class="n">ruby_global_allocator</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">uuid</span><span class="p">::</span><span class="n">Uuid</span><span class="p">;</span>

<span class="nd">ruby_global_allocator!</span><span class="p">();</span>

<span class="c1">// UUIDv4 ã‚’æ–‡å­—åˆ—ã¨ã—ã¦å…¬é–‹</span>
<span class="k">fn</span> <span class="nf">v4</span><span class="p">()</span> <span class="k">-&gt;</span> <span class="nb">String</span> <span class="p">{</span>
    <span class="nn">Uuid</span><span class="p">::</span><span class="nf">new_v4</span><span class="p">()</span><span class="nf">.to_string</span><span class="p">()</span>
<span class="p">}</span>

<span class="nd">#[magnus::init]</span>
<span class="k">fn</span> <span class="nf">init</span><span class="p">()</span> <span class="k">-&gt;</span> <span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span> <span class="n">Error</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">let</span> <span class="n">module</span> <span class="o">=</span> <span class="nf">define_module</span><span class="p">(</span><span class="s">"RustUUID"</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
    <span class="c1">// RustUUID.v4 ã¨åˆ©ç”¨ã™ã‚‹ã‚ˆã†ã«ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©</span>
    <span class="n">module</span><span class="nf">.define_singleton_method</span><span class="p">(</span><span class="s">"v4"</span><span class="p">,</span> <span class="nd">function!</span><span class="p">(</span><span class="n">v4</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span><span class="o">?</span><span class="p">;</span>
    <span class="nf">Ok</span><span class="p">(())</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ã“ã‚Œã¾ã§ã§ããŸã‚‰ä¸€æ—¦ Rust ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¾ã—ã‚‡ã†ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> <span class="nb">cd </span>ext/rust_uuid
<span class="o">&gt;</span> cargo build
<span class="o">&gt;</span> git add <span class="nb">.</span>
<span class="o">&gt;</span> rake build
.... <span class="c"># install cargo dependencies and packages</span>
<span class="nb">cp</span>: <span class="s1">'/home/katsyoshi/Program/Ruby/rust_uuid/tmp/x86_64-linux/rust_uuid/3.1.2/target/release/librust_uuid.so'</span> ã‚’ <span class="nb">stat </span>ã§ãã¾ã›ã‚“: ãã®ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ã‚ã‚Šã¾ã›ã‚“
gmake: <span class="k">***</span> <span class="o">[</span>Makefile:551: foo_bar.so] ã‚¨ãƒ©ãƒ¼ 1
rake aborted!
Command failed with status <span class="o">(</span>2<span class="o">)</span>: <span class="o">[</span>/usr/bin/gmake...]

Tasks: TOP <span class="o">=&gt;</span> build <span class="o">=&gt;</span> compile <span class="o">=&gt;</span> compile:x86_64-linux <span class="o">=&gt;</span> compile:foo_bar:x86_64-linux <span class="o">=&gt;</span> copy:rust_uuid:x86_64-linux:3.1.2 <span class="o">=&gt;</span> tmp/x86_64-linux/rust_uuid/3.1.2/rust_uuid.so
</code></pre></div></div>

<p>ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚
ã“ã‚Œã¯ <code class="language-plaintext highlighter-rouge">ext/rust_uuid/Cargo.toml</code> ã®è¨­å®šãŒè¶³ã‚Šã¦ã„ã¾ã›ã‚“ã€‚ãã“ã§ä»¥ä¸‹ã‚’è¿½åŠ ã—ã¦ã¿ã¦ãã ã•ã„ã€‚</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[lib]</span>
<span class="py">crate-type</span> <span class="p">=</span> <span class="p">[</span><span class="s">"cdylib"</span><span class="p">]</span>
</code></pre></div></div>

<p>è¿½åŠ ã—ãŸã‚‰ <code class="language-plaintext highlighter-rouge">gem</code> ã‚’ãƒ“ãƒ«ãƒ‰&amp;&amp;ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«&amp;&amp;è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†!</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> rake <span class="nb">install</span>
....
<span class="o">&gt;</span> ruby <span class="nt">-rrust_uuid</span> <span class="nt">-e</span> <span class="s1">'puts RustUUID.v4'</span>
2be6f4d2-200b-4d08-9a1a-11fa523b316b
</code></pre></div></div>

<h2 id="ã¹ã‚“ã¡ã¾ãƒ¼ã">ã¹ã‚“ã¡ã¾ãƒ¼ã</h2>

<p>ä»¥ä¸‹ã€ <code class="language-plaintext highlighter-rouge">SecureRandom.uuid</code> ã¨ã®æ¯”è¼ƒç”¨ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚³ãƒ¼ãƒ‰ã‚’ç¤ºã—ã¾ã™ã€‚</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">require</span> <span class="s2">"benchmark/ips"</span>
<span class="nb">require</span> <span class="s2">"securerandom"</span>
<span class="nb">require</span> <span class="s2">"rust_uuid"</span>

<span class="no">Benchmark</span><span class="p">.</span><span class="nf">ips</span> <span class="k">do</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span>
  <span class="n">x</span><span class="p">.</span><span class="nf">report</span><span class="p">(</span><span class="s2">"standard"</span><span class="p">)</span> <span class="p">{</span> <span class="no">SecureRandom</span><span class="p">.</span><span class="nf">uuid</span> <span class="p">}</span>
  <span class="n">x</span><span class="p">.</span><span class="nf">report</span><span class="p">(</span><span class="s2">"rust lib"</span><span class="p">)</span> <span class="p">{</span> <span class="no">RustUUID</span><span class="p">.</span><span class="nf">v4</span> <span class="p">}</span>
  <span class="n">x</span><span class="p">.</span><span class="nf">compare!</span>
<span class="k">end</span>
</code></pre></div></div>

<h3 id="çµæœç™ºè¡¨">çµæœç™ºè¡¨ã€œ</h3>

<p>Rust ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã ã„ãŸã„ 5 å€ã»ã©é€Ÿããªã£ã¦ã„ã¾ã™ã€‚</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>ruby bentimark.rb
<span class="go">Warming up --------------------------------------
            standard    36.437k i/100ms
            rust lib   177.585k i/100ms
Calculating -------------------------------------
            standard    365.407k (Â± 1.4%) i/s -      1.858M in   5.086491s
            rust lib      1.793M (Â± 1.8%) i/s -      9.057M in   5.053179s

Comparison:
            rust lib:  1792925.9 i/s
            standard:   365407.3 i/s - 4.91x  (Â± 0.00) slower

ruby bentimark.rb  9.88s user 4.30s system 99% cpu 14.175 total
</span></code></pre></div></div>

<p>TOO HAYAI</p>

<h2 id="ã¾ã¨ã‚">ã¾ã¨ã‚</h2>
<p>ç°¡å˜ã« Rust ã‚’åˆ©ç”¨ã—ã¦é€Ÿãã—ã¦ã¿ã¾ã—ãŸã€‚
æ€ã£ãŸä»¥ä¸Šã«é€Ÿããªã£ã¦ã„ãŸã®ã§é‡ã„å‡¦ç†ã‚’ã™ã‚‹å ´åˆã« <code class="language-plaintext highlighter-rouge">C</code> ã‚„ <code class="language-plaintext highlighter-rouge">C++</code> ä»¥å¤–ã§ã‚‚ç°¡å˜ã«åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦
é¸æŠè‚¢ãŒå¢—ãˆãŸã®ã¯ã‚ˆã„ã“ã¨ã§ã—ãŸã€‚</p>

<p>å®Ÿã¯ã“ã® <code class="language-plaintext highlighter-rouge">uuid</code> crate ã® features ã« <code class="language-plaintext highlighter-rouge">fast-rng</code> ã‚’è¿½åŠ ã™ã‚‹ã¨ 10 å€é€Ÿããªã‚‹ã‚“ã§ã™ãŒã€ ruby å´ã®çµ‚äº†æ™‚ã« <code class="language-plaintext highlighter-rouge">SEGV</code> ã—ã¦ã—ã¾ã†ã®ã§è¼‰ã›ã¦ã„ãªã„ã§ã™ã€‚ <code class="language-plaintext highlighter-rouge">SEGV</code> ã—ãªã„ã‚ˆã†ã«åŸå› ã‚’èª¿æŸ»ãªã©ã¯ã¾ãŸä»Šåº¦ã€‚</p>

  </div>

  <h1><a href="/blog/2022/03/19/hello-wezterm/">Hello, Wezterm</a></h1>
  <p class="author">
    <span class="date">2022-03-19 18:00:00 +0900</span>
  </p>
  <div class="content">
    <p><a href="https://github.com/tmux/tmux"><code class="language-plaintext highlighter-rouge">tmux</code></a> + <a href="https://github.com/tmux/tmux"><code class="language-plaintext highlighter-rouge">Allacritty</code></a> ãŒç–²ã‚Œã¦ããŸã®ã§<a href="https://zenn.dev/yutakatay/articles/wezterm-intro">ã¯ã¦ã¶ã§æµã‚Œã¦ããŸ</a> <a href="https://github.com/wez/wezterm"><code class="language-plaintext highlighter-rouge">wezterm</code></a> ãŒ <a href="https://github.com/saitoha/libsixel"><code class="language-plaintext highlighter-rouge">sixel</code></a> ã‚’åˆ©ç”¨ã§ãã¦ã‚ˆã•ãã†ã ã£ãŸã®ã§è©¦ã—ã¦ã¿ã‚‹ã“ã¨ã«ã—ãŸã€‚</p>

<h2 id="è¨­å®š">è¨­å®š</h2>

<p>è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒ <a href="https://www.lua.org/">lua</a> ã§ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒã„ã‚ã„ã‚ã¨ã§ãã‚‹ã®ã§ã¾ãšã¯è‰²ã‚’ä»£ãˆã¦ã¿ã¾ã™ã€‚</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">local</span> <span class="n">wezterm</span> <span class="o">=</span> <span class="nb">require</span> <span class="s1">'wezterm'</span>
<span class="k">return</span> <span class="p">{</span>
  <span class="n">color_scheme</span> <span class="o">=</span> <span class="s2">"Dracula"</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã§ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒã§ãã‚‹ã®ã§ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¿ãƒ–ã¸ã®ç§»å‹•ã®ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒã§ãã¾ã™ã€‚</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">local</span> <span class="n">wezterm</span> <span class="o">=</span> <span class="nb">require</span> <span class="s1">'wezterm'</span>
<span class="kd">local</span> <span class="n">move_keys</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span> <span class="k">do</span>
   <span class="nb">table.insert</span><span class="p">(</span><span class="n">move_keys</span><span class="p">,</span> <span class="p">{</span>
      <span class="n">key</span> <span class="o">=</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
      <span class="n">mods</span> <span class="o">=</span> <span class="s2">"CTRL"</span><span class="p">,</span>
      <span class="n">action</span> <span class="o">=</span> <span class="n">wezterm</span><span class="p">.</span><span class="n">action</span><span class="p">{</span> <span class="n">ActivateTab</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">},</span>
   <span class="p">})</span>
<span class="k">end</span>

<span class="k">return</span> <span class="p">{</span>
   <span class="n">color_scheme</span> <span class="o">=</span> <span class="s2">"Dracula"</span><span class="p">,</span>
   <span class="n">disable_default_key_bindings</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">-- åˆæœŸã®ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã¯åˆ©ç”¨ã—ãªã„å ´åˆ</span>
   <span class="n">keys</span> <span class="o">=</span> <span class="n">move_keys</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ã“ã‚“ãªæ„Ÿã˜ã§è¨­å®šã§ãã‚‹ã®ã§ä¾¿åˆ©ã§ã™ã€‚</p>

<p>ã“ã®ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã¯ä»»æ„ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚‚è¨­å®šã§ãã€ä»»æ„ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’åˆ©ç”¨ã—ã¦ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®šç¾©ã§ãã¾ã™ã€‚ä»¥ä¸‹ã®ä¾‹ã§ã¯ã€Paneã‚’é–‹ã„ç›£è¦–ç”¨ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’é–‹ãã¾ã™ã€‚</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">local</span> <span class="n">wezterm</span> <span class="o">=</span> <span class="nb">require</span> <span class="s1">'wezterm'</span>
<span class="n">wezterm</span><span class="p">.</span><span class="n">on</span><span class="p">(</span><span class="s2">"open-nvtop-and-ytop"</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="n">win</span><span class="p">,</span> <span class="n">pane</span><span class="p">)</span>
   <span class="n">win</span><span class="p">:</span><span class="n">perform_action</span><span class="p">(</span><span class="n">wezterm</span><span class="p">.</span><span class="n">action</span><span class="p">{</span> <span class="n">SplitHorizontal</span> <span class="o">=</span> <span class="p">{</span> <span class="n">domain</span> <span class="o">=</span> <span class="s2">"CurrentPaneDomain"</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">"nvtop"</span><span class="p">,</span> <span class="p">},</span> <span class="p">},</span> <span class="p">},</span> <span class="n">pane</span><span class="p">)</span>
   <span class="n">win</span><span class="p">:</span><span class="n">perform_action</span><span class="p">(</span><span class="n">wezterm</span><span class="p">.</span><span class="n">action</span><span class="p">{</span> <span class="n">SplitVertical</span> <span class="o">=</span> <span class="p">{</span> <span class="n">domain</span> <span class="o">=</span> <span class="s2">"CurrentPaneDomain"</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">"ytop"</span><span class="p">,</span> <span class="s2">"-ps"</span><span class="p">,</span> <span class="p">},</span> <span class="p">},</span> <span class="p">},</span> <span class="n">pane</span><span class="p">)</span>
<span class="k">end</span><span class="p">)</span>

<span class="k">return</span> <span class="p">{</span>
   <span class="n">keys</span> <span class="o">=</span> <span class="p">{</span> <span class="p">{</span> <span class="n">key</span> <span class="o">=</span> <span class="s2">"r"</span><span class="p">,</span> <span class="n">mods</span> <span class="o">=</span> <span class="s2">"CTRL"</span><span class="p">,</span> <span class="n">action</span> <span class="o">=</span> <span class="n">wezterm</span><span class="p">.</span><span class="n">action</span><span class="p">{</span> <span class="n">EmitEvent</span> <span class="o">=</span> <span class="s2">"open-nvtop-and-ytop"</span><span class="p">,</span> <span class="p">},</span> <span class="p">},</span> <span class="p">},</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ã¨ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
<img src="/images/screenshot/open-nvtop-and-ytop-in-wezterm.png" width="100%" />
ä¾¿åˆ©!</p>

<p>ã“ã‚“ãªä¾¿åˆ©ãªã‚‚ã®ã¨ã„ã†ã“ã¨ã§ <code class="language-plaintext highlighter-rouge">systemd</code> ã§ãƒ‡ãƒ¼ãƒ¢ãƒ³åŒ–ã—ã¦ã„ã¾ã™ã€‚</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[Unit]</span>
<span class="py">Description</span><span class="p">=</span><span class="err">GUI</span> <span class="err">Accellarated</span> <span class="err">terminal</span>
<span class="py">Documentation</span><span class="p">=</span>

<span class="nn">[Service]</span>
<span class="py">Type</span><span class="p">=</span><span class="err">forking</span>
<span class="py">ExecStart</span><span class="p">=</span><span class="err">/usr/local/bin/wezterm-mux-server</span> <span class="err">--daemonize</span>
<span class="py">Restart</span><span class="p">=</span><span class="err">on-failure</span>

<span class="nn">[Install]</span>
<span class="py">WantedBy</span><span class="p">=</span><span class="err">default.target</span>
</code></pre></div></div>

<p>ã§èµ·å‹•ã—ã¦ãŠã„ã¦ã„ã¾ã™</p>

<h3 id="å•é¡Œç‚¹">å•é¡Œç‚¹</h3>

<p>ã¨è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä¾‹æ›¸ã„ã¦ã¿ãŸã®ã§ã™ãŒã€ã¨ã¦ã‚‚å¤§ããªå•é¡Œç‚¹ã«ãƒ–ãƒã‚ãŸã£ãŸã®ã§æ›¸ã„ã¦ãŠãã¾ã™ã€‚</p>

<p><code class="language-plaintext highlighter-rouge">wezterm</code> ã«ã¯ <code class="language-plaintext highlighter-rouge">wezterm-mux-server</code> ã¨ã„ã†ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¯ã‚µ(tmuxã®ã‚ˆã†ã«æ‰±ã†ãŸã‚)ã®ã‚µãƒ¼ãƒãƒ¼ãƒ¢ãƒ¼ãƒ‰ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒã‚ã‚‹ã®ã§ã™ãŒã€ã“ã„ã¤ãŒã©ã†ã‚‚ <code class="language-plaintext highlighter-rouge">wezterm</code> ã¨ã¯æŒ™å‹•ãŒç•°ãªã‚Šã€å‰è¿°ã—ãŸç›£è¦–ç”¨ã®ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ãŒå¾®å¦™ã«ç•°ãªã£ãŸæŒ™å‹•ã¨ãªã£ã¦ã—ã¾ã£ã¦ã„ã¾ã™ã€‚ã‚µãƒ¼ãƒãƒ¼ãƒ¢ãƒ¼ãƒ‰ã«æ¥ç¶šã—ãŸå ´åˆã®æŒ™å‹•ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>

<p><img src="/images/screenshot/failed-nvtop-ytop.png" width="100%" /></p>

<p>1ã¤ç›®ã¯paneã®ä½ç½®ãŒæœŸå¾…ã—ãŸã¨ãŠã‚Šã«ãªã£ã¦ã„ãªã„ã€‚2ã¤ç›®ã¯ <code class="language-plaintext highlighter-rouge">ytop</code> ãŒèµ·å‹•ã—ã¦ã„ãªã„ã¨ã„ã†ã®ã§2ã¤ç›®ã®æ–¹ã¯æ°—ã«ã—ãªã‘ã‚Œã°ã„ã„ã®ã§ã¾ã‚ã„ã„ã‹ã¨æ€ã£ã¦ã„ã‚‹ã€‚1ã¤ç›®ã®å•é¡Œã¯è¨±å®¹ã§ãã¦ã„ãªã„ã®ã§ä¸€æ—¦ã¯ã“ã®ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã¯å°å°ã¨ãªã£ã¦ã„ã¾ã™ã€‚</p>

<h1 id="ãŠã‚ã‚Š">ãŠã‚ã‚Š</h1>

<p>é•·å¹´åˆ©ç”¨ã—ã¦ãŸ <code class="language-plaintext highlighter-rouge">tmux</code> ã‚’æ¨ã¦ã¦ <code class="language-plaintext highlighter-rouge">wezterm</code> ã‚’åˆ©ç”¨ã—ã¯ã˜ã‚ãŸã€‚
è¨­å®šãŒ <code class="language-plaintext highlighter-rouge">lua</code> ã§æ›¸ã‘ã‚‹ã®ãŒä½“é¨“çš„ã«ã¨ã¦ã‚‚è‰¯ã„ã®ã§ã“ã‚Œã‹ã‚‰ã‚‚åˆ©ç”¨ã™ã‚‹ã‹ãªã¨ã€‚
<code class="language-plaintext highlighter-rouge">wezterm</code> ã§ <code class="language-plaintext highlighter-rouge">sixel</code> åˆ©ç”¨ã—ãŸç”»åƒè¡¨ç¤ºãŒã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã®ãŒä¾¿åˆ©ãªã®ã§ã€Œã‚ˆã—ã£ï¼ã€</p>


  </div>

  <h1><a href="/blog/2022/01/03/hello-2022/">å†¬ã‚„ã™ã¿</a></h1>
  <p class="author">
    <span class="date">2022-01-03 23:59:59 +0900</span>
  </p>
  <div class="content">
    <p>å†¬ã‚„ã™ã¿ã®é–“ã€ã‚„ã‚ŠãŸã„ã“ã¨ã€ã‚„ã£ã¨ã„ãŸã»ã†ãŒã„ã„ã‚„ã¤ã‚’ã‚„ã£ã¦ã¾ã—ãŸã€‚
ã²ã¨ã¤ã¯ <a href="/blog/2021/12/26/xremap/">xremap</a> ã®è¨­å®šã¨ã‚‚ã†ã²ã¨ã¤ã¯ <a href="/blog/2021/12/30/custom-co2mini-co2-sensor/">CO2-mini ã‹ã‚‰ CO<sub>2</sub> ã‚’è¦‹ãˆã‚‹</a> ã‚ˆã†ã«ã—ãŸã€‚</p>

<p>ä»Šå›ã¯ã€ <a href="https://mackerel.io"><strong>mackerel</strong></a> ã§è¦‹ãˆã‚‹ã‚ˆã†ã«ãªã£ãŸ <strong>CO<sub>2</sub></strong> ã®å€¤ã‚’ <strong>Slack</strong> ã¸å®šæœŸçš„ã«æŠ•ã’ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ä»Šå›ã‚‚ <a href="https://www.rust-lang.org"><strong>Rust</strong></a> ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚</p>

<h2 id="æº–å‚™">æº–å‚™</h2>

<p>æº–å‚™ã¨ã—ã¦ã€ <strong>mackerel</strong> <sup id="fnref:mackerel-token" role="doc-noteref"><a href="#fn:mackerel-token" class="footnote" rel="footnote">1</a></sup> ã¨ <strong>Slack</strong> <sup id="fnref:slack-token" role="doc-noteref"><a href="#fn:slack-token" class="footnote" rel="footnote">2</a></sup>
ä¸¡ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æŠ•ç¨¿ API ç”¨ Token ã‚’ãã‚Œãã‚Œç”¨æ„ã—ã¾ã™ã€‚
å„å…¬å¼ãƒšãƒ¼ã‚¸ã«ã‚ã‚‹ã‚ˆã†ã«ç”Ÿæˆã€å–å¾—ã™ã‚‹ã ã‘ã§ã‚ˆã„ã§ã™ã€‚</p>

<p><strong>mackerel</strong> å´ã¯ <a href="https://mackerel.io/ja/api-docs/entry/host-metrics#get">ãƒ›ã‚¹ãƒˆãƒ¡ãƒˆãƒªãƒƒã‚¯ API</a> ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚
<strong>Slack</strong> å´ã¯ <a href="https://api.slack.com/methods/chat.postMessage">chat.postMessage API</a> ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚
å„ API ã«å¯¾ã—ã¦å–å¾—ã—ãŸ API Token ã‚’ç”¨ã„ã¦ <code class="language-plaintext highlighter-rouge">curl</code> ã§ç¢ºèªã—ã¦ãŠãã¾ã™ã€‚</p>

<h2 id="å®Ÿè£…">å®Ÿè£…</h2>

<p>ä»Šå›ã¯å¯¾è©±å¼ã® <strong>bot</strong> ã§ã¯ãªã„ã®ã§ã€ <a href="https://api.slack.com/rtm"><strong>RTM</strong></a> ã‚’åˆ©ç”¨ã›ãšã«ã€<strong>HTTP</strong> ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã ã‘ã§æ§‹æˆã—ã¦ã„ã¾ã™<sup id="fnref:slack-rs" role="doc-noteref"><a href="#fn:slack-rs" class="footnote" rel="footnote">3</a></sup>ã€‚
<strong>Rust</strong> ã® <strong>HTTP</strong> ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã—ã¦ <a href="https://github.com/hyperium/hyper"><strong>hyper</strong></a><sup id="fnref:hyper-warning" role="doc-noteref"><a href="#fn:hyper-warning" class="footnote" rel="footnote">4</a></sup> ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚
<strong>TLS</strong> ã¯ <a href="https://github.com/hyperium/hyper-tls"><strong>hyper_tls</strong></a> ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚</p>

<p>å®Ÿè£…ã¨ã¯è¨€ã£ã¦ã‚‚å¯¾è±¡ã® <strong>mackerel</strong> ã® APIã‚’å©ãå€¤ã‚’å–å¾—ã—ã¦ã€
ãã®å€¤ã‚’å…ƒã« <strong>Slack</strong> ã¸ãƒã‚¹ãƒˆã™ã‚‹ã ã‘ã§ã™ã€‚</p>

<p><strong>mackerel</strong> ã§ã®å€¤å–å¾—æ™‚ã«æ°—ã‚’ã¤ã‘ã‚‹ç‚¹ã¨ã—ã¦ã¯ã€<strong>ãƒ›ã‚¹ãƒˆãƒ¡ãƒˆãƒªãƒƒã‚¯ API</strong> ã§ã¯ <code class="language-plaintext highlighter-rouge">hostå</code> ã§ã¯ãªãã€
<code class="language-plaintext highlighter-rouge">host id</code> ãŒãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¨ãªã£ã¦ã„ã¾ã™ã®ã§æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚
ã¾ãšãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å…¥ã‚Œã‚‹æ§‹é€ ä½“ã‚’å®šç¾©ã—ã¾ã™ã€‚</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">#[derive(Deserialize)]</span>
<span class="k">pub</span> <span class="k">struct</span> <span class="n">Metric</span> <span class="p">{</span>
    <span class="k">pub</span> <span class="n">time</span><span class="p">:</span> <span class="nb">i64</span><span class="p">,</span>
    <span class="k">pub</span> <span class="n">value</span><span class="p">:</span> <span class="nb">i16</span><span class="p">,</span> <span class="c1">// ä»Šå›ã¯ co2 ã®å€¤ãªã®ã§ i16 ã¨ã—ã¦ã„ã‚‹</span>
<span class="p">}</span>

<span class="nd">#[derive(Deserialize)]</span>
<span class="k">pub</span> <span class="k">struct</span> <span class="n">ResponseMetrics</span> <span class="p">{</span>
    <span class="k">pub</span> <span class="n">metrics</span><span class="p">:</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="n">Metric</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ã¤ãã«ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’çµ„ã¿ãŸã¦ã¦ã€å€¤ã‚’å–å¾—ã—ã¦ã„ã¾ã™ã€‚</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="n">https</span> <span class="o">=</span> <span class="nn">HttpsConnector</span><span class="p">::</span><span class="nf">new</span><span class="p">();</span>
<span class="k">let</span> <span class="n">req</span> <span class="o">=</span> <span class="nn">hyper</span><span class="p">::</span><span class="nn">Request</span><span class="p">::</span><span class="nf">builder</span><span class="p">()</span>
    <span class="nf">.method</span><span class="p">(</span><span class="nn">hyper</span><span class="p">::</span><span class="nn">Method</span><span class="p">::</span><span class="n">GET</span><span class="p">)</span>
    <span class="nf">.uri</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="nf">.header</span><span class="p">(</span><span class="s">"X-Api-Key"</span><span class="p">,</span> <span class="n">api_key</span><span class="p">)</span>
    <span class="nf">.body</span><span class="p">(</span><span class="nn">hyper</span><span class="p">::</span><span class="nn">Body</span><span class="p">::</span><span class="nf">empty</span><span class="p">())</span><span class="o">?</span><span class="p">;</span>
<span class="c1">// https ã¨ã—ã¦ request ã™ã‚‹</span>
<span class="k">let</span> <span class="n">client</span> <span class="o">=</span> <span class="nn">hyper</span><span class="p">::</span><span class="nn">Client</span><span class="p">::</span><span class="nf">builder</span><span class="p">()</span><span class="py">.build</span><span class="p">::</span><span class="o">&lt;</span><span class="n">_</span><span class="p">,</span> <span class="nn">hyper</span><span class="p">::</span><span class="n">Body</span><span class="o">&gt;</span><span class="p">(</span><span class="n">https</span><span class="p">);</span>
<span class="k">let</span> <span class="n">res</span> <span class="o">=</span> <span class="n">client</span><span class="nf">.request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span><span class="k">.await</span><span class="o">?</span><span class="p">;</span>
<span class="k">let</span> <span class="n">body</span> <span class="o">=</span> <span class="nn">hyper</span><span class="p">::</span><span class="nn">body</span><span class="p">::</span><span class="nf">aggregate</span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="k">.await</span><span class="o">?</span><span class="p">;</span>
<span class="k">let</span> <span class="n">json</span><span class="p">:</span> <span class="n">ResponseMetrics</span> <span class="o">=</span> <span class="nn">serde_json</span><span class="p">::</span><span class="nf">from_reader</span><span class="p">(</span><span class="n">body</span><span class="nf">.reader</span><span class="p">())</span><span class="o">?</span><span class="p">;</span>
<span class="k">let</span> <span class="n">metrics</span> <span class="o">=</span> <span class="n">json</span><span class="py">.metrics</span><span class="p">;</span>
</code></pre></div></div>

<p>å€¤ã‚’å–å¾—ã—ãŸã‚‰ã€ä»Šåº¦ã¯åŒã˜ã‚ˆã†ã« <strong>Slack</strong> ã®æ–¹ã‚‚æ§‹é€ ä½“ã‚’å®šç¾©ã—ã¾ã™ã€‚</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ãƒªã‚¯ã‚¨ã‚¹ãƒˆç”¨æ§‹é€ ä½“</span>
<span class="nd">#[derive(Serialize)]</span>
<span class="k">pub</span> <span class="k">struct</span> <span class="n">SlackMessage</span> <span class="p">{</span>
    <span class="k">pub</span> <span class="n">channel</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="k">pub</span> <span class="n">sub_type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="k">pub</span> <span class="n">text</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="k">pub</span> <span class="n">username</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="k">pub</span> <span class="n">as_user</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">}</span>
<span class="c1">// ãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”¨æ§‹é€ ä½“</span>
<span class="nd">#[derive(Deserialize)]</span>
<span class="k">pub</span> <span class="k">struct</span> <span class="n">PostMessage</span> <span class="p">{</span>
    <span class="nd">#[allow(unused)]</span>
    <span class="n">channel</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>
<p>ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’çµ„ã¿ãŸã¦ã¦ã€POSTã—ã¾ã™ã€‚
è¦‹ã¦ã‚ã‹ã‚‹ã¨æ€ã„ã¾ã™ãŒã€ã»ã¨ã‚“ã© <strong>mackerel</strong> ã¨å¤‰ã‚ã‚‰ãªã„ã§ã™ã€‚</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ãƒªã‚¯ã‚¨ã‚¹ãƒˆ body ã‚’ json ã«å¤‰æ›</span>
<span class="k">let</span> <span class="n">json</span> <span class="o">=</span> <span class="nn">serde_json</span><span class="p">::</span><span class="nf">to_string</span><span class="p">(</span><span class="o">&amp;</span><span class="n">SlackMessage</span> <span class="p">{</span>
    <span class="n">channel</span><span class="p">:</span> <span class="s">"channel"</span><span class="nf">.to_string</span><span class="p">(),</span>
    <span class="n">sub_type</span><span class="p">:</span> <span class="s">"bot_message"</span><span class="nf">.to_string</span><span class="p">(),</span>
    <span class="n">text</span><span class="p">:</span> <span class="s">"message"</span><span class="nf">.to_string</span><span class="p">(),</span>
    <span class="n">username</span><span class="p">:</span> <span class="s">"botname"</span><span class="nf">.to_string</span><span class="p">(),</span>
    <span class="n">as_user</span><span class="p">:</span> <span class="k">true</span><span class="p">,</span>
<span class="p">})</span><span class="o">?</span><span class="p">;</span>

<span class="k">let</span> <span class="n">https</span> <span class="o">=</span> <span class="nn">hyper_tls</span><span class="p">::</span><span class="nn">HttpsConnector</span><span class="p">::</span><span class="nf">new</span><span class="p">();</span>
<span class="k">let</span> <span class="n">req</span> <span class="o">=</span> <span class="nn">hyper</span><span class="p">::</span><span class="nn">Request</span><span class="p">::</span><span class="nf">builder</span><span class="p">()</span>
    <span class="nf">.method</span><span class="p">(</span><span class="nn">hyper</span><span class="p">::</span><span class="nn">Method</span><span class="p">::</span><span class="n">POST</span><span class="p">)</span>
    <span class="nf">.uri</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="nf">.header</span><span class="p">(</span><span class="s">"Content-Type"</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">)</span>
    <span class="nf">.header</span><span class="p">(</span><span class="s">"Authorization"</span><span class="p">,</span> <span class="nd">format!</span><span class="p">(</span><span class="s">"Bearer {}"</span><span class="p">,</span> <span class="nf">get_env</span><span class="p">(</span><span class="s">"SLACK_API_KEY"</span><span class="p">)))</span>
    <span class="nf">.body</span><span class="p">(</span><span class="nn">hyper</span><span class="p">::</span><span class="nn">Body</span><span class="p">::</span><span class="nf">from</span><span class="p">(</span><span class="n">json</span><span class="p">))</span><span class="o">?</span><span class="p">;</span>

<span class="k">let</span> <span class="n">client</span> <span class="o">=</span> <span class="nn">hyper</span><span class="p">::</span><span class="nn">Client</span><span class="p">::</span><span class="nf">builder</span><span class="p">()</span><span class="py">.build</span><span class="p">::</span><span class="o">&lt;</span><span class="n">_</span><span class="p">,</span> <span class="nn">hyper</span><span class="p">::</span><span class="n">Body</span><span class="o">&gt;</span><span class="p">(</span><span class="n">https</span><span class="p">);</span>
<span class="k">let</span> <span class="n">res</span> <span class="o">=</span> <span class="n">client</span><span class="nf">.request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span><span class="k">.await</span><span class="o">?</span><span class="p">;</span>
<span class="k">let</span> <span class="n">body</span> <span class="o">=</span> <span class="nn">hyper</span><span class="p">::</span><span class="nn">body</span><span class="p">::</span><span class="nf">aggregate</span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="k">.await</span><span class="o">?</span><span class="p">;</span>
<span class="k">let</span> <span class="n">_json</span><span class="p">:</span> <span class="n">PostMessage</span> <span class="o">=</span> <span class="nn">serde_json</span><span class="p">::</span><span class="nf">from_reader</span><span class="p">(</span><span class="n">body</span><span class="nf">.reader</span><span class="p">())</span><span class="o">?</span><span class="p">;</span>
</code></pre></div></div>

<p>ãƒã‚¹ãƒˆã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œã‚‹éš›ã«2ã¤ã®ã“ã¨ã‚’ã—ã¦ã„ã¾ã™ã€‚
ã¾ãšã¯ <code class="language-plaintext highlighter-rouge">time</code> ã® <strong>UNIX EPOCH TIME</strong> ã‹ã‚‰ãƒ­ãƒ¼ã‚«ãƒ«ã®æ™‚é–“ã‚’è¡¨ç¤ºã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚
ãã‚Œã¨ <strong>CO<sub>2</sub></strong> ã®å€¤ã«ä¾ã£ã¦çµµæ–‡å­—ã‚’è¿½åŠ ã™ã‚‹ã‹ã©ã†ã‹ã‚’å…¥ã‚Œã¦ã„ã¾ã™ã€‚ <code class="language-plaintext highlighter-rouge">-1</code> ã¨ã‹äºˆå®šã—ã¦ã„ãªã„å€¤ãŒå…¥ã£ã¦ããŸå ´åˆã¯ <code class="language-plaintext highlighter-rouge">panic!</code> ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚</p>

<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// chrono ã‚’åˆ©ç”¨ã—ã¦ unix time ã‹ã‚‰ãƒ­ãƒ¼ã‚«ãƒ«ã®æ–‡å­—åˆ—ã¸å¤‰æ›</span>
<span class="k">let</span> <span class="n">t</span> <span class="o">=</span> <span class="nn">chrono</span><span class="p">::</span><span class="n">Local</span><span class="nf">.timestamp</span><span class="p">(</span><span class="n">time</span><span class="p">);</span>
<span class="k">let</span> <span class="n">v</span> <span class="o">=</span> <span class="k">match</span> <span class="n">value</span> <span class="p">{</span>
    <span class="mi">0</span><span class="o">..=</span><span class="mi">700</span> <span class="k">=&gt;</span> <span class="s">":large_green_circle:"</span><span class="p">,</span>
    <span class="mi">701</span><span class="o">..=</span><span class="mi">1000</span> <span class="k">=&gt;</span> <span class="s">":large_yellow_circle:"</span><span class="p">,</span>
    <span class="mi">1001</span><span class="o">..</span> <span class="k">=&gt;</span> <span class="s">":red_circle:"</span><span class="p">,</span> <span class="c1">// ãªã‚“ã§ slack ã¯ :large_red_circle: ã‚’ç”¨æ„ã—ã¦ã„ãªã„ã‚“ã ã‚ã†ã‹</span>
    <span class="n">_</span> <span class="k">=&gt;</span> <span class="nd">panic!</span><span class="p">(</span><span class="s">"unexpected number!!"</span><span class="p">),</span>
<span class="p">};</span>
</code></pre></div></div>

<p>ã“ã†ã‚„ã£ã¦ãƒã‚¹ãƒˆã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>

<p><img src="/images/screenshot/posted-slack-message.png" alt="" /></p>

<p>çµµæ–‡å­—ã¤ãã§ãƒã‚¹ãƒˆã•ã‚Œã¾ã—ãŸã­ã€‚</p>

<h2 id="ã¾ã¨ã‚">ã¾ã¨ã‚</h2>

<p><strong>Rust</strong> ã§ <strong>bot</strong> ã‚’ä½œã£ã¦ã¿ã¾ã—ãŸã€‚
ã¨è¨€ã£ã¦ã‚‚ãŸã ã® <strong>HTTP ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ</strong> ãª <strong>bot</strong> ãªã ã‘ã§ã™ã‘ã©ã€‚
ä¸€æ—¦ <strong>Slack</strong> ã§ã‚‚è¦‹ãˆã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã§ä»Šåº¦ã¯ <a href="https://nature.global"><strong>Nature Remo</strong></a> ã¨é€£æºã—ã¦æ°—æ¸©ã‚„æ¹¿åº¦ã§ã®è‡ªå‹•åŒ–ãŒã§ããŸã‚‰ã„ã„ãªã€‚</p>

<hr />

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:mackerel-token" role="doc-endnote">
      <p>https://mackerel.io/ja/api-docs/Â <a href="#fnref:mackerel-token" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:slack-token" role="doc-endnote">
      <p>https://slack.com/intl/ja-jp/help/articles/215770388-API-%E3%83%88%E3%83%BC%E3%82%AF%E3%83%B3%E3%81%AE%E7%94%9F%E6%88%90%E3%81%A8%E5%86%8D%E7%94%9F%E6%88%90Â <a href="#fnref:slack-token" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:slack-rs" role="doc-endnote">
      <p><a href="https://github.com/slack-rs/slack-rs">slack-rs</a> ã¨ã„ã†ä¾¿åˆ©ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚ã‚‹ã®ã§ã™ãŒã€ã¡ã‚‡ã£ã¨è§¦ã£ã¦ã¿ãŸã“ã‚Œã¯å¿…è¦ãªã‚“ã ã£ã‘ï¼Ÿã¨ãªã£ã¦ã‚„ã‚ã¾ã—ãŸã€‚Â <a href="#fnref:slack-rs" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:hyper-warning" role="doc-endnote">
      <p><a href="https://github.com/hyperium/hyper#low-level">å…¬å¼ã® README</a> ã«ã‚ã‚‹ã‚ˆã†ã«ã“ã®å ´åˆã¯ <a href="https://github.com/seanmonstar/reqwest"><strong>reqwest</strong></a> ã‚’åˆ©ç”¨ã™ã‚‹ã»ã†ãŒã‚ˆã‹ã£ãŸã‹ã‚‚ã—ã‚Œãªã„ã€‚<strong>TLS</strong> ã¯ç›´æ¥ <strong>hyper</strong> ãŒå¯¾å¿œã—ã¦ã„ãªã‹ã£ãŸã‚Šã—ã¦ã™ã“ã—é¢å€’ã§ã™ã€‚Â <a href="#fnref:hyper-warning" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

  </div>

  <h1><a href="/blog/2021/12/31/me-and-coffee/">ä»Šå¹´é£²ã‚“ã ã‚³ãƒ¼ãƒ’ãƒ¼è±†ã®ç¨®é¡ 2021</a></h1>
  <p class="author">
    <span class="date">2021-12-31 23:59:59 +0900</span>
  </p>
  <div class="content">
    <p>ä»Šå¹´ã‚‚ã‚³ãƒ­ãƒŠã§ã©ã“ã«ã‚‚è¡Œãã«ã—ã¦ã‚‚è¡Œãã«ãã‹ã£ãŸã—ã€
åº—ã‚‚ã©ã“ã‚‚ã‚ã¾ã‚Šã‚„ã£ã¦ãªã‹ã£ãŸã‚ˆã†ã ã£ãŸã®ã§ä»Šå¹´ã‚‚é…’ã§ã¯ãªã„ã¾ã¨ã‚ã‚’ã€‚</p>

<p>è‹¦ã„ã‚³ãƒ¼ãƒ’ãƒ¼ã™ã“ã—é£½ãã¦ããŸãªãƒ¼ã¨ã‹ã€ã‚ã‚“ã¾ã‚Šå¤§é‡ã«ã®ã‚€ã®ã¯ãªãƒ¼ã¨æ€ã£ã¦ãŸã¨ã“ã‚<sup id="fnref:coffee" role="doc-noteref"><a href="#fn:coffee" class="footnote" rel="footnote">1</a></sup>ã«
ã‚¹ãƒšã‚·ãƒ£ãƒ«ãƒ†ã‚£ã‚³ãƒ¼ãƒ’ãƒ¼å°‚é–€åº—ãŒè¿‘æ‰€ã«ã§ãã¦ã„ã¦ã€ãã“ã§é£²ã‚“ã§æ•™ãˆã¦ã‚‚ã‚‰ã£ãŸã‚³ãƒ¼ãƒ’ãƒ¼ãŒ
æ°—ã«å…¥ã‚Šã‚ˆãé€šã†ã‚ˆã†ã«ã€‚</p>

<p>æ™®æ®µã®é£²ã‚€é‡ã‚’1æ—¥1æ¯ã®ã¿ã«æŠ‘ãˆã‚‹ãŸã‚ã«å¤šå°‘é«˜ãã¦ã‚‚ãŠã„ã—ã„è±†ã§1æ¯ã§æº€è¶³ã§ãã‚‹è±†ã‚’è²·ã†ã“ã¨ã«ã—ãŸã€‚</p>

<h2 id="è±†">è±†</h2>

<p>è²·ã£ãŸã¨ã„ã†ã®ãŒã‚ã‹ã£ã¦ã„ã‚‹è±†ã€‚</p>

<ul>
  <li>HAMBELA WAMENA, HEIRLOOM, Natural, ã‚¨ãƒã‚ªãƒ”ã‚¢</li>
  <li>Carmo De Minas Santuario Sul, Yellow Bourbon, Citrus Sweetness, ãƒ–ãƒ©ã‚¸ãƒ«</li>
  <li>NYERI KARATINA, SL<sub>28</sub>SL<sub>32</sub>RUIRU<sub>11</sub>, Fully Washed, ã‚±ãƒ‹ã‚¢</li>
  <li>KAKAMEGA ISULU, SL<sub>28</sub>SL<sub>32</sub>RUIRU<sub>11</sub>, Natural Anaerobic, ã‚±ãƒ‹ã‚¢</li>
  <li>WEST ARSI GORA KONE, HEIRLOOM, Washed, ã‚¨ãƒã‚ªãƒ”ã‚¢</li>
  <li>GEDEB WORKA, HEIRLOOM, Special Process Natural, ã‚¨ãƒã‚ªãƒ”ã‚¢</li>
  <li>EL PARAISO RED FRUITS, CASTILLO, DOUBLE ANAEROBIC WASHED, ã‚³ãƒ­ãƒ³ãƒ“ã‚¢</li>
  <li>EL PARAISO LYCHEE, CASTILLO, DOUBLE ANAEROBIC WASHED, ã‚³ãƒ­ãƒ³ãƒ“ã‚¢</li>
  <li>NYERI MAGANJO, SL<sub>28</sub>SL<sub>32</sub>RUIRU<sub>11</sub>, Fully Washed, ã‚±ãƒ‹ã‚¢</li>
  <li>Fazenda Guariroba, Yellow Catuai, Double Fermentation Black Honey, ãƒ–ãƒ©ã‚¸ãƒ«</li>
</ul>

<h2 id="æ„Ÿæƒ³">æ„Ÿæƒ³</h2>

<p>ã‚’æ›¸ãã¤ã‚‚ã‚ŠãŒã€ãã‚‚ãã‚‚æ„Ÿæƒ³ãƒ¡ãƒ¢ã‚’ã»ã¨ã‚“ã©æ®‹ã—ã¦ã„ãªã‹ã£ãŸã€‚ã„ãã¤ã‹æ®‹ã—ã¦ã„ã‚‹ã®ã§ãã‚Œã‚’ã€‚</p>

<ul>
  <li>EL PARAISO RED FRUITS: åˆ¥ãƒ­ãƒƒãƒˆã¯ãƒ”ãƒ¼ãƒãƒ†ã‚£ã®ã‚ˆã†ãªæ„Ÿã˜ã§ã‚ã£ãŸãŒã€ä»Šå›ã¯ã‹ãªã‚Šãƒ•ãƒ«ãƒ¼ãƒ†ã‚£ãªå‘³ã§ãƒ©ã‚¤ãƒãªæ„Ÿã˜ã§ã™ã€‚</li>
  <li>Fazenda Guariroba: é¦™ã‚ŠãŒæŸ‘æ©˜ç³»ã¨ã„ã†ã‹ãƒ¬ãƒ¢ãƒ³ã®é¦™ã‚ŠãŒã™ã‚‹ã€‚å‘³ã¯ã‚¹ãƒƒã‚­ãƒªã—ã¦ã¦å£ã«å«ã‚“ã é…¸å‘³ã¯å°‘ãªãã€å¾Œå‘³ã¨ã—ã¦ã®é…¸å‘³ãŒå¼·ãã®ã“ã£ã¦ç¾å‘³ã—ã„ã€‚</li>
</ul>

<h2 id="ã¾ã¨ã‚">ã¾ã¨ã‚</h2>

<p>1å¹´ãã‚‰ã„å‰ã«ç¤¾å†… <strong>Slack</strong> ã«ã‚³ãƒ¼ãƒ’ãƒ¼ã®æ„Ÿæƒ³ã‚’ã¾ã¨ã‚ã‚‹ãŸã‚ã®ãƒãƒ£ãƒ³ãƒãƒ«ä½œã£ãŸã‘ã©ã€
ã¾ã£ãŸãæ´»ç”¨ã—ã¦ã„ãªãã¦æ„Ÿæƒ³ãŒã»ã¨ã‚“ã©æ®‹ã£ã¦ã„ãªã„ã€‚
ãŠã„ã—ã„ã“ã¨ä»¥å¤–ã¯æ€ã„ã ã›ã‚‹ã‚ã‘ã‚‚ãªãâ€¦â€¦</p>

<hr />
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:coffee" role="doc-endnote">
      <p>ã“ã“1,2å¹´ã‚³ãƒ¼ãƒ’ãƒ¼é£²ã¿ã™ãã‚‹ã¨èƒƒãŒç—›ããªã‚‹ã®ã«æ°—ãŒã¤ã„ãŸã€‚Â <a href="#fnref:coffee" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

  </div>


<!-- Pagination links -->
<div class="pagination">
  
    <a href="/" class="previous">
      Previous
    </a>
  
  <span class="page_number ">
    Page: 2 of 12
  </span>
  
    <a href="/page/3/" class="next">Next</a>
  
</div>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">katsyoshi ã®ã‚ã‚‚ã¿ãŸã„ãªã®</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">katsyoshi ã®ã‚ã‚‚ã¿ãŸã„ãªã®</li><li><a class="u-email" href="mailto:web@katsyoshi.org">web@katsyoshi.org</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/katsyoshi"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">katsyoshi</span></a></li><li><a href="https://www.twitter.com/katsyoshi"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">katsyoshi</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>It&#39;s a memos.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
